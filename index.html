<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Parker – Underwriting Tool</title>

  <!-- Google Fonts & Chart.js -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    :root {
      --chat-width: 260px;
      --nav-width: 220px;
      --bg: #0f0f0f;
      --panel: #1a1a1a;
      --border: #2a2a2a;
      --text: #ffffff;
      --muted: #a3a3a3;
      --accent: #ff6833;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; font-family: "Inter", sans-serif; }

    body { display: flex; height: 100vh; background: var(--bg); color: var(--text); overflow: hidden; }

    /* ---------------- CHAT (RIGHT) ---------------- */
    .chat-sidebar { width: var(--chat-width); background: var(--panel); border-left: 1px solid var(--border); display: flex; flex-direction: column; margin-left: auto; }
    .chat-header { padding: 1rem; font-weight: 600; border-bottom: 1px solid var(--border); }
    .chat-messages { flex: 1; padding: 1rem; overflow-y: auto; display: flex; flex-direction: column; gap: 0.75rem; }
    .msg { max-width: 90%; padding: 0.5rem 0.75rem; border-radius: 0.6rem; font-size: 0.85rem; }
    .user { align-self: flex-end; background: var(--accent); }
    .bot  { align-self: flex-start; background: var(--border); }
    .chat-input { border-top: 1px solid var(--border); padding: 0.75rem; }
    .chat-input input { width: 100%; padding: 0.55rem 0.75rem; border-radius: 0.4rem; border: 1px solid var(--border); background: var(--bg); color: var(--text); }

    /* ---------------- NAVIGATION SIDEBAR (hidden initially) ---------------- */
    aside { width: var(--nav-width); background: var(--panel); flex-direction: column; padding: 1rem; border-right: 1px solid var(--border); overflow-y: auto; display: none; }
    .brand { display: flex; align-items: center; gap: 0.5rem; font-weight: 600; margin-bottom: 1.25rem; font-size: 1rem; }
    .brand .dot { width: 10px; height: 10px; border-radius: 50%; background: linear-gradient(140deg,#d850ff,#ff6833); }
    .back-btn { cursor: pointer; display: flex; align-items: center; background: var(--border); border-radius: 4px; padding: 0.25rem 0.5rem; margin-right: 0.5rem; font-size: 0.8rem; }
    .back-btn:hover { background: #3a3a3a; }

    .nav-item { cursor: pointer; padding: 0.55rem 0.75rem; margin: 0.15rem 0; border-radius: 0.5rem; display: flex; justify-content: space-between; align-items: center; font-size: 0.95rem; transition: background .2s; user-select:none; }
    .nav-item:hover { background: var(--border);}  
    .submenu { display:none; flex-direction:column; margin-left:0.75rem; }
    .submenu a { text-decoration:none; color:var(--muted); font-size:0.8rem; padding:0.3rem 0; cursor:pointer; }

    /* ---------------- MAIN ---------------- */
    main { flex:1; overflow-y:auto; padding:2rem; }
    h1 { font-size:1.5rem; font-weight:600; margin-bottom:1.5rem; }

    .grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(220px,1fr)); gap:1rem; }
    .card { background:var(--panel); border:1px solid var(--border); border-radius:.75rem; padding:1rem; display:flex; flex-direction:column; }
    .card h3 { font-size:1rem; font-weight:500; margin-bottom:.75rem; }
    .metric { font-size:1.85rem; font-weight:600; line-height:1.2; }
    .small { font-size:.8rem; color:var(--muted); margin-top:.25rem; }
    canvas { width:100% !important; height:150px !important; }

    /* ---------------- UNDERWRITING TABLE ---------------- */
    .uw-table { width: 100%; border-collapse: collapse; margin-top: 1rem; }
    .uw-table th { text-align: left; padding: 0.75rem 1rem; border-bottom: 1px solid var(--border); color: var(--muted); font-weight: 500; font-size: 0.85rem; }
    .uw-table td { padding: 0.75rem 1rem; border-bottom: 1px solid var(--border); }
    .uw-table tr { cursor: pointer; transition: background .2s; }
    .uw-table tr:hover { background: var(--panel); }
    .uw-table .company-name { font-weight: 500; }
    .uw-table .review-type { font-size: 0.85rem; }
    .tag { display: inline-block; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.75rem; }
    .tag-new { background: rgba(0, 180, 120, 0.2); color: rgb(0, 210, 140); }
    .tag-reuw { background: rgba(100, 100, 255, 0.2); color: rgb(130, 130, 255); }
    .tag-risk { background: rgba(255, 80, 80, 0.2); color: rgb(255, 120, 120); }
    .tag-status { background: rgba(255, 180, 0, 0.2); color: rgb(255, 180, 0); }
    .tag-done { background: rgba(120, 120, 120, 0.2); color: rgb(160, 160, 160); }
    .reason { font-size: 0.85rem; color: var(--muted); }

    /* ---------------- TABS ---------------- */
    .tabs { display: flex; margin-bottom: 1.5rem; border-bottom: 1px solid var(--border); }
    .tab { padding: 0.75rem 1.5rem; cursor: pointer; position: relative; font-size: 0.9rem; color: var(--muted); }
    .tab.active { color: var(--text); }
    .tab.active::after { content: ""; position: absolute; bottom: -1px; left: 0; width: 100%; height: 2px; background: var(--accent); }
    .tab-content { display: none; }
    .tab-content.active { display: block; }

    /* ---------------- COMPANY VIEW ---------------- */
    .company-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; }
    .start-uw-btn { background: var(--accent); color: var(--text); border: none; border-radius: 4px; padding: 0.6rem 1.2rem; cursor: pointer; font-weight: 500; }
    .start-uw-btn:hover { background: #ff5820; }
    
    /* Company Overview Nav + Content Layout */
    .company-overview { display: flex; gap: 2rem; }
    .company-nav { width: 220px; flex-shrink: 0; }
    .company-content { flex: 1; }
    
    /* Company Nav Styling */
    .company-nav-item { padding: 0.75rem 1rem; cursor: pointer; border-left: 2px solid transparent; margin-bottom: 0.2rem; }
    .company-nav-item:hover { background: rgba(255, 255, 255, 0.05); }
    .company-nav-item.active { border-left-color: var(--accent); background: rgba(255, 255, 255, 0.05); }
    .company-subnav { padding-left: 1rem; font-size: 0.9rem; color: var(--muted); }
    .company-subnav-item { padding: 0.5rem 1rem; cursor: pointer; }
    .company-subnav-item:hover { color: var(--text); }
    
    /* Company Info Section */
    .info-section { margin-bottom: 2rem; }
    .info-section h2 { font-size: 1.2rem; margin-bottom: 1rem; font-weight: 500; }
    .info-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; }
    .info-item { background: var(--panel); border: 1px solid var(--border); padding: 1rem; border-radius: 0.5rem; }
    .info-item-label { font-size: 0.8rem; color: var(--muted); margin-bottom: 0.25rem; }
    .info-item-value { font-size: 1rem; }

    /* Main container */
    .bs-container {
      border: 1px solid var(--border);
      border-radius: 8px;
      overflow: hidden;
      background: var(--bg);
    }
    
    /* Table basics */
    .bs-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.85rem;
    }
    .bs-table th {
      padding: 0.75rem;
      text-align: left;
      position: sticky;
      top: 0;
      background: var(--panel);
      z-index: 10;
      border-bottom: 1px solid var(--border);
    }
    .bs-table td {
      padding: 0.75rem;
      border-bottom: 1px solid var(--border);
    }
    
    /* Level 1 - Top level categories (non-movable) */
    .bs-level1 {
      font-weight: 700;
      font-size: 0.95rem;
      background: var(--panel);
      cursor: not-allowed;
    }
    .bs-level1 td:first-child {
      border-left: 3px solid var(--accent);
    }
    .bs-level1:hover {
      background: var(--panel);
    }
    
    /* Level 2 - Subcategories (non-movable) */
    .bs-level2 {
      font-weight: 600;
      background: rgba(26, 26, 26, 0.6);
      cursor: not-allowed;
    }
    .bs-level2 td:first-child {
      padding-left: 2rem !important;
      border-left: 2px solid var(--border);
    }
    .bs-level2:hover {
      background: rgba(26, 26, 26, 0.6);
    }
    
    /* Level 3 - Sub-subcategories (non-movable) */
    .bs-level3 {
      font-weight: 500;
      background: rgba(26, 26, 26, 0.4);
      cursor: not-allowed;
    }
    .bs-level3 td:first-child {
      padding-left: 3.5rem !important;
      border-left: 1px solid var(--border);
    }
    .bs-level3:hover {
      background: rgba(26, 26, 26, 0.4);
    }
    
    /* Level 4 - Line items (movable) */
    .bs-level4 {
      background: transparent;
    }
    .bs-level4 td:first-child {
      padding-left: 5rem !important;
    }
    .bs-level4.draggable {
      cursor: move;
    }
    .bs-level4.dragging {
      opacity: 0.5;
      background: rgba(255, 104, 51, 0.2);
    }
  </style>
</head>
<body>
  <!-- NAVIGATION SIDEBAR (hidden initially) -->
  <aside id="navSidebar">
    <div class="brand">
      <div class="back-btn" id="backBtn">← Back</div>
      <span class="dot"></span>
      <span id="brandName">Parker</span>
    </div>
    <div class="nav-item" id="companyBtn" data-screen="getStarted">Parker Group, Inc.</div>

    <nav>
      <div class="nav-item" data-target="uwInfo">Underwriting Information <span>▸</span></div>
      <div class="submenu" id="uwInfo"><a data-screen="uwDetails">UW Details</a></div>

      <div class="nav-item" data-screen="dataGathering">Data gathering</div>

      <div class="nav-item" data-target="labeling">Labeling <span>▸</span></div>
      <div class="submenu" id="labeling"><a data-screen="plLabeling">Profit & loss labeling</a><a data-screen="bsLabeling">Balance sheet labeling</a><a data-screen="bankLabeling">Banking labeling</a></div>

      <div class="nav-item" data-target="metricCalc">Metric Calculation <span>▸</span></div>
      <div class="submenu" id="metricCalc"><a data-screen="graphsMetrics">Graphs & metric decisions</a></div>

      <div class="nav-item" data-target="spend">Spend <span>▸</span></div>
      <div class="submenu" id="spend"><a data-screen="spendBanking">Banking</a><a data-screen="spendParker">Parker</a></div>

      <div class="nav-item" data-screen="scoring">Scoring</div>

      <div class="nav-item" data-target="decisions">Decisions <span>▸</span></div>
      <div class="submenu" id="decisions"><a data-screen="securities">Securities</a><a data-screen="finalDecisions">Final decisions</a></div>
    </nav>
  </aside>

  <!-- COMPANY OVERVIEW SIDEBAR -->
  <aside id="companyOverviewSidebar" style="display:none;">
    <div class="brand">
      <div class="back-btn" id="backToListBtn">← Back</div>
      <span class="dot"></span>
      <span id="companyOverviewName">Parker</span>
    </div>
    
    <nav>
      <div class="nav-item" data-target="companyInfo">Company information <span>▸</span></div>
      <div class="submenu" id="companyInfo" style="display:flex;">
        <a data-company-screen="companyDetails">Company information</a>
        <a data-company-screen="currentOffer">Current offer</a>
      </div>

      <div class="nav-item" data-company-screen="historicalUW">Historical Underwriting</div>
      <div class="nav-item" data-company-screen="dataConnectivity">Data connectivity</div>
      <div class="nav-item" data-company-screen="kyb">KYB / KYC</div>
    </nav>
  </aside>

  <!-- MAIN CONTENT AREA -->
  <main id="mainContent"></main>
  
  <!-- CHAT SIDEBAR -->
  <div class="chat-sidebar">
    <div class="chat-header">Copilot</div>
    <div class="chat-messages" id="chatMessages"><div class="msg bot">Hi! I'm your underwriting copilot – ask me anything.</div></div>
    <div class="chat-input"><input id="chatInput" type="text" placeholder="Type a message…"></div>
  </div>

  <script>
    /******************** CHAT LOGIC (unchanged) *************************/
    const chatInput = document.getElementById('chatInput');
    const chatMessages = document.getElementById('chatMessages');
    chatInput.addEventListener('keydown', e => { if(e.key==='Enter' && chatInput.value.trim()){ const t=chatInput.value.trim(); addMessage(t,'user'); chatInput.value=''; setTimeout(()=>addMessage('Noted! I will look into that.','bot'),600);} });
    function addMessage(text,type){ const div=document.createElement('div'); div.className=`msg ${type}`; div.textContent=text; chatMessages.appendChild(div); chatMessages.scrollTop=chatMessages.scrollHeight; }

    /******************** EXISTING NAV DROPDOWN LOGIC (unchanged) *************************/
    document.querySelectorAll('.nav-item[data-target]').forEach(item=>{ item.addEventListener('click', ()=>{ const submenu=document.getElementById(item.dataset.target); if(submenu){ const open=submenu.style.display==='flex'; submenu.style.display=open?'none':'flex'; const arrow=item.querySelector('span:last-child'); if(arrow) arrow.textContent=open?'▸':'▾'; }});});

    /******************** EXISTING SCREEN ROUTING *************************/
    document.querySelectorAll('[data-screen]').forEach(el => { 
      el.addEventListener('click', () => { 
        // Check if we're in company view or UW mode
        if (document.getElementById('companyOverviewSidebar').style.display === 'flex') {
          // We're in company view mode, use regular load
          loadScreen(el.dataset.screen);
        } else {
          // We're in UW mode, preserve the back button
          const companyName = document.getElementById('companyBtn').textContent;
          loadScreenWithCompanyReturn(el.dataset.screen, companyName);
        }
      });
    });

    function loadScreen(screen) { 
      const main = document.getElementById('mainContent'); 
      main.innerHTML = ''; 
      if (screen === 'getStarted') { 
        renderGetStarted(main);
      } else if (screen === 'plLabeling') {
        renderPLLabeling(main);
      } else if (screen === 'bsLabeling') {
        renderBSLabeling(main);
      } else if (screen === 'bankLabeling') {
        renderBankLabeling(main);
      } else if (screen === 'spendBanking') {
        renderSpendBanking(main);
      } else if (screen === 'spendParker') {
        renderSpendParker(main);
      } else if (screen === 'dataGathering') {
        renderDataGathering(main);
      } else if (screen === 'scoring') {
        renderScoring(main);
      } else if (screen === 'graphsMetrics') {
        renderGraphsMetrics(main);
      } else { 
        const h = document.createElement('h1'); 
        h.textContent = screen.replace(/([A-Z])/g, ' $1'); 
        h.style.fontSize = '1.25rem'; 
        main.appendChild(h);
      } 
    }

    /******************** ORIGINAL GET STARTED RENDERER (unchanged) *************************/
    function renderGetStarted(container, addingToExisting) {
      // If we're adding to existing content, don't clear the container
      if (!addingToExisting) {
        container.innerHTML = '';
      }
      
      const contentDiv = document.createElement('div');
      contentDiv.innerHTML = `<h1>Get Started</h1><div class="grid"><div class="card"><h3>Credit</h3><div class="small">Credit Available</div><div class="metric">$212,935.87</div><div class="small" style="margin-top:1rem">Utilization</div><div class="metric" style="font-size:1.25rem">54.8%</div></div><div class="card"><h3>Banking</h3><div class="small">Cash Balance</div><div class="metric">$5,043</div></div><div class="card"><h3>Insights</h3><div class="small">Net Sales</div><div class="metric">$20,124</div><div class="small" style="margin-top:1rem">Contribution Profit</div><div class="metric" style="font-size:1.25rem">$7,217</div></div><div class="card" style="grid-column:span 2"><h3>Float: Daily Cash Boost</h3><div class="metric" style="margin-bottom:0.75rem">$172,398</div><canvas id="floatChart"></canvas></div><div class="card"><h3>Rewards</h3><div class="small">Points Balance</div><div class="metric">984,052</div><a href="#" style="color:var(--accent); font-size:0.85rem; text-decoration:underline; margin-top:0.5rem;">Redeem</a></div></div>`;
      container.appendChild(contentDiv);
      
      const ctx = document.getElementById('floatChart').getContext('2d'); 
      new Chart(ctx, { 
        type: 'line', 
        data: { 
          labels: Array.from({length: 30}, (_, i) => `Day ${i+1}`), 
          datasets: [{ 
            label: 'Balance', 
            data: Array.from({length: 30}, () => Math.random()*50+150), 
            fill: true, 
            tension: 0.3 
          }, { 
            label: 'Spend', 
            data: Array.from({length: 30}, () => Math.random()*60+50), 
            tension: 0.3, 
            borderDash: [5, 5] 
          }]
        }, 
        options: { 
          responsive: true, 
          maintainAspectRatio: false, 
          plugins: { 
            legend: { 
              display: false 
            }
          }, 
          scales: { 
            x: { 
              display: false 
            }, 
            y: { 
              display: false 
            }
          }
        }
      }); 
    }

    /******************** NEW: UNDERWRITING LIST & FLOW *************************/
    // New company data structure with review types, reasons and status
    const companyData = [
      {
        name: 'Parker Group, Inc.',
        reviewType: 'New Onboarding',
        reason: '',
        status: 'Open'
      },
      {
        name: 'Zephyr Labs',
        reviewType: 'Re-Underwriting',
        reason: 'Re-Underwriting Fixed Cadence',
        status: 'Open'
      },
      {
        name: 'Nimbus Retail Co.',
        reviewType: 'Risk Alert',
        reason: 'Keyword',
        status: 'Open'
      },
      {
        name: 'Orion Foods LLC',
        reviewType: 'New Onboarding',
        reason: '',
        status: 'Open'
      },
      {
        name: 'Helios Energy Ltd.',
        reviewType: 'Re-Underwriting',
        reason: 'Potential Upgrade',
        status: 'Open'
      },
      {
        name: 'Vertex Apparel',
        reviewType: 'Risk Alert',
        reason: 'Material Amount',
        status: 'Open'
      },
      {
        name: 'Apex Logistics',
        reviewType: 'Re-Underwriting',
        reason: 'Potential Downgrade',
        status: 'Open'
      },
      {
        name: 'Quanta Health',
        reviewType: 'Risk Alert',
        reason: 'Copilot Alert',
        status: 'Open'
      },
      // Historical entries with "Done" status
      {
        name: 'Atlas Medical Inc.',
        reviewType: 'New Onboarding',
        reason: '',
        status: 'Done'
      },
      {
        name: 'Nova Tech Solutions',
        reviewType: 'Re-Underwriting',
        reason: 'Re-Underwriting Fixed Cadence',
        status: 'Done'
      },
      {
        name: 'Polaris Manufacturing',
        reviewType: 'Risk Alert',
        reason: 'Material Amount',
        status: 'Done'
      },
      {
        name: 'Lumina Therapeutics',
        reviewType: 'New Onboarding',
        reason: '',
        status: 'Done'
      },
      {
        name: 'Cascade Logistics',
        reviewType: 'Re-Underwriting',
        reason: 'Potential Downgrade',
        status: 'Done'
      }
    ];

    function renderUnderwritingList(container) {
      // Clear any existing content first
      container.innerHTML = '';
      
      container.innerHTML = '<h1>Underwriting Workload</h1>';
      
      // Create tabs
      const tabsContainer = document.createElement('div');
      tabsContainer.className = 'tabs';
      tabsContainer.innerHTML = `
        <div class="tab active" data-tab="new-onboardings">New Onboardings</div>
        <div class="tab" data-tab="existing-clients">Existing Clients</div>
        <div class="tab" data-tab="historical">Historical Activity</div>
      `;
      container.appendChild(tabsContainer);
      
      // Create tab content containers
      const newOnboardingsTab = document.createElement('div');
      newOnboardingsTab.className = 'tab-content active';
      newOnboardingsTab.id = 'tab-new-onboardings';
      
      const existingClientsTab = document.createElement('div');
      existingClientsTab.className = 'tab-content';
      existingClientsTab.id = 'tab-existing-clients';
      
      const historicalTab = document.createElement('div');
      historicalTab.className = 'tab-content';
      historicalTab.id = 'tab-historical';
      
      // Filter companies by type and status
      const newOnboardings = companyData.filter(company => 
        company.reviewType === 'New Onboarding' && company.status === 'Open');
      
      const existingClients = companyData.filter(company => 
        company.reviewType !== 'New Onboarding' && company.status === 'Open');
      
      const historical = companyData.filter(company => 
        company.status === 'Done');
      
      // Render tables for each tab
      renderCompanyTable(newOnboardingsTab, newOnboardings);
      renderCompanyTable(existingClientsTab, existingClients);
      renderCompanyTable(historicalTab, historical);
      
      // Add tab content to container
      container.appendChild(newOnboardingsTab);
      container.appendChild(existingClientsTab);
      container.appendChild(historicalTab);
      
      // Add tab switching functionality
      tabsContainer.querySelectorAll('.tab').forEach(tab => {
        tab.addEventListener('click', () => {
          // Toggle active class on tabs
          tabsContainer.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
          tab.classList.add('active');
          
          // Toggle active class on content
          container.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
          document.getElementById('tab-' + tab.dataset.tab).classList.add('active');
        });
      });
    }
    
    function renderCompanyTable(container, companies) {
      if (companies.length === 0) {
        container.innerHTML = '<p style="color: var(--muted); padding: 1rem 0;">No companies to display</p>';
        return;
      }
      
      // Create table
      const table = document.createElement('table');
      table.className = 'uw-table';
      
      // Add table header
      const thead = document.createElement('thead');
      thead.innerHTML = `
        <tr>
          <th>Company</th>
          <th>Type of Review</th>
          <th>Reason for Review</th>
          <th>Status</th>
        </tr>
      `;
      table.appendChild(thead);
      
      // Add table body
      const tbody = document.createElement('tbody');
      companies.forEach(company => {
        const tr = document.createElement('tr');
        
        // Get tag class based on review type
        let tagClass = '';
        if (company.reviewType === 'New Onboarding') tagClass = 'tag-new';
        else if (company.reviewType === 'Re-Underwriting') tagClass = 'tag-reuw';
        else if (company.reviewType === 'Risk Alert') tagClass = 'tag-risk';
        
        // Get status tag class
        let statusTagClass = company.status === 'Done' ? 'tag-done' : 'tag-status';
        
        tr.innerHTML = `
          <td class="company-name">${company.name}</td>
          <td><span class="tag ${tagClass}">${company.reviewType}</span></td>
          <td class="reason">${company.reason}</td>
          <td><span class="tag ${statusTagClass}">${company.status}</span></td>
        `;
        
        tr.addEventListener('click', () => selectUnderwriting(company.name));
        tbody.appendChild(tr);
      });
      
      table.appendChild(tbody);
      container.appendChild(table);
    }

    function selectUnderwriting(name) {
      // Clear main content completely first
      const main = document.getElementById('mainContent');
      main.innerHTML = '';
      
      // Show company overview instead of UW sidebar
      document.getElementById('navSidebar').style.display = 'none';
      document.getElementById('companyOverviewSidebar').style.display = 'flex';
      
      // Update company name in overview
      document.getElementById('companyOverviewName').textContent = name;
      
      // Render company overview screen
      renderCompanyOverview(name);
    }

    /******************** NEW: COMPANY OVERVIEW SCREEN *************************/
    function renderCompanyOverview(companyName) {
      const main = document.getElementById('mainContent');
      main.innerHTML = ''; // Ensure main content is completely clear
      
      // Create header with company name and Start UW button
      const header = document.createElement('div');
      header.className = 'company-header';
      header.innerHTML = `
        <h1>Company View: ${companyName}</h1>
        <button class="start-uw-btn" id="startUWBtn">Start new UW</button>
      `;
      main.appendChild(header);
      
      // Create overview container with navigation and content
      const overviewContainer = document.createElement('div');
      overviewContainer.className = 'company-overview';
      
      // Create company content area
      const contentArea = document.createElement('div');
      contentArea.className = 'company-content';
      contentArea.id = 'companyContentArea';
      
      // Add content to container
      overviewContainer.appendChild(contentArea);
      main.appendChild(overviewContainer);
      
      // Load default screen (company details)
      loadCompanyScreen('companyDetails');
      
      // Add event listener for Start UW button
      document.getElementById('startUWBtn').addEventListener('click', () => {
        startNewUnderwriting(companyName);
      });
      
      // Add event listeners for company navigation
      document.querySelectorAll('[data-company-screen]').forEach(item => {
        item.addEventListener('click', () => {
          loadCompanyScreen(item.dataset.companyScreen);
        });
      });
    }
    
    // Load company screen content
    function loadCompanyScreen(screen) {
      const contentArea = document.getElementById('companyContentArea');
      contentArea.innerHTML = '';
      
      // Make sure main content only contains company view content
      const main = document.getElementById('mainContent');
      if (main.querySelector('.company-header') === null) {
        // If we lost the company header, re-render the company view
        renderCompanyOverview(document.getElementById('companyOverviewName').textContent);
        return;
      }
      
      // Highlight active navigation item
      document.querySelectorAll('[data-company-screen]').forEach(item => {
        if (item.dataset.companyScreen === screen) {
          item.parentElement.classList.add('active');
        } else {
          item.parentElement.classList.remove('active');
        }
      });
      
      // Render content based on screen
      switch(screen) {
        case 'companyDetails':
          renderCompanyDetails(contentArea);
          break;
        case 'currentOffer':
          renderCurrentOffer(contentArea);
          break;
        case 'historicalUW':
          renderHistoricalUW(contentArea);
          break;
        case 'dataConnectivity':
          renderDataConnectivity(contentArea);
          break;
        case 'kyb':
          renderKYB(contentArea);
          break;
        default:
          contentArea.innerHTML = '<p>Select a section from the menu</p>';
      }
    }
    
    // Render company details screen
    function renderCompanyDetails(container) {
      const section = document.createElement('div');
      section.className = 'info-section';
      section.innerHTML = `
        <h2>Company Information</h2>
        <div class="info-grid">
          <div class="info-item">
            <div class="info-item-label">Company Name</div>
            <div class="info-item-value">${document.getElementById('companyOverviewName').textContent}</div>
          </div>
          <div class="info-item">
            <div class="info-item-label">Industry</div>
            <div class="info-item-value">Technology</div>
          </div>
          <div class="info-item">
            <div class="info-item-label">Incorporation Date</div>
            <div class="info-item-value">Jan 15, 2018</div>
          </div>
          <div class="info-item">
            <div class="info-item-label">Business Type</div>
            <div class="info-item-value">Corporation</div>
          </div>
          <div class="info-item">
            <div class="info-item-label">Address</div>
            <div class="info-item-value">123 Main St, San Francisco, CA 94105</div>
          </div>
          <div class="info-item">
            <div class="info-item-label">Annual Revenue</div>
            <div class="info-item-value">$3.2M</div>
          </div>
        </div>
      `;
      container.appendChild(section);
    }
    
    // Render current offer screen
    function renderCurrentOffer(container) {
      const section = document.createElement('div');
      section.className = 'info-section';
      section.innerHTML = `
        <h2>Current Offer</h2>
        <div class="info-grid">
          <div class="info-item">
            <div class="info-item-label">Credit Limit</div>
            <div class="info-item-value">$250,000</div>
          </div>
          <div class="info-item">
            <div class="info-item-label">APR</div>
            <div class="info-item-value">16.5%</div>
          </div>
          <div class="info-item">
            <div class="info-item-label">Payment Terms</div>
            <div class="info-item-value">Net 30</div>
          </div>
          <div class="info-item">
            <div class="info-item-label">Cash Advance Rate</div>
            <div class="info-item-value">1.5%</div>
          </div>
          <div class="info-item">
            <div class="info-item-label">Approval Date</div>
            <div class="info-item-value">Mar 12, 2023</div>
          </div>
          <div class="info-item">
            <div class="info-item-label">Next Review</div>
            <div class="info-item-value">Mar 12, 2024</div>
          </div>
        </div>
      `;
      container.appendChild(section);
    }
    
    // Render historical underwriting screen
    function renderHistoricalUW(container) {
      const section = document.createElement('div');
      section.className = 'info-section';
      section.innerHTML = `
        <h2>Historical Underwriting</h2>
        <table class="uw-table">
          <thead>
            <tr>
              <th>Date</th>
              <th>Type</th>
              <th>Decision</th>
              <th>Credit Limit</th>
              <th>APR</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Mar 12, 2023</td>
              <td><span class="tag tag-reuw">Re-Underwriting</span></td>
              <td>Approved</td>
              <td>$250,000</td>
              <td>16.5%</td>
            </tr>
            <tr>
              <td>Sep 5, 2022</td>
              <td><span class="tag tag-risk">Risk Alert</span></td>
              <td>No Change</td>
              <td>$200,000</td>
              <td>17.2%</td>
            </tr>
            <tr>
              <td>Mar 10, 2022</td>
              <td><span class="tag tag-reuw">Re-Underwriting</span></td>
              <td>Upgraded</td>
              <td>$200,000</td>
              <td>17.2%</td>
            </tr>
            <tr>
              <td>Mar 8, 2021</td>
              <td><span class="tag tag-new">New Onboarding</span></td>
              <td>Approved</td>
              <td>$150,000</td>
              <td>18.5%</td>
            </tr>
          </tbody>
        </table>
      `;
      container.appendChild(section);
    }
    
    // Render data connectivity screen
    function renderDataConnectivity(container) {
      const section = document.createElement('div');
      section.className = 'info-section';
      section.innerHTML = `
        <h2>Data Connectivity</h2>
        <div class="info-grid">
          <div class="info-item">
            <div class="info-item-label">Banking Connection</div>
            <div class="info-item-value">✅ Connected (Chase)</div>
          </div>
          <div class="info-item">
            <div class="info-item-label">Accounting Software</div>
            <div class="info-item-value">✅ Connected (QuickBooks)</div>
          </div>
          <div class="info-item">
            <div class="info-item-label">Payment Processor</div>
            <div class="info-item-value">✅ Connected (Stripe)</div>
          </div>
          <div class="info-item">
            <div class="info-item-label">Last Data Refresh</div>
            <div class="info-item-value">Today, 08:45 AM</div>
          </div>
          <div class="info-item">
            <div class="info-item-label">Data Quality Score</div>
            <div class="info-item-value">92/100</div>
          </div>
          <div class="info-item">
            <div class="info-item-label">Data Completeness</div>
            <div class="info-item-value">98%</div>
          </div>
        </div>
      `;
      container.appendChild(section);
    }
    
    // Render KYB/KYC screen
    function renderKYB(container) {
      const section = document.createElement('div');
      section.className = 'info-section';
      section.innerHTML = `
        <h2>KYB / KYC</h2>
        <div class="info-grid">
          <div class="info-item">
            <div class="info-item-label">Business Verification</div>
            <div class="info-item-value">✅ Verified</div>
          </div>
          <div class="info-item">
            <div class="info-item-label">Identity Verification</div>
            <div class="info-item-value">✅ Verified</div>
          </div>
          <div class="info-item">
            <div class="info-item-label">Business Registration</div>
            <div class="info-item-value">✅ Verified</div>
          </div>
          <div class="info-item">
            <div class="info-item-label">Tax ID</div>
            <div class="info-item-value">✅ Verified</div>
          </div>
          <div class="info-item">
            <div class="info-item-label">Beneficial Owners</div>
            <div class="info-item-value">✅ Verified (2)</div>
          </div>
          <div class="info-item">
            <div class="info-item-label">Risk Score</div>
            <div class="info-item-value">Low</div>
          </div>
        </div>
      `;
      container.appendChild(section);
    }
    
    /******************** START NEW UNDERWRITING *************************/
    function startNewUnderwriting(companyName) {
      // Hide company overview sidebar
      document.getElementById('companyOverviewSidebar').style.display = 'none';
      
      // Show UW sidebar
      document.getElementById('navSidebar').style.display = 'flex';
      
      // Set company name
      document.getElementById('companyBtn').textContent = companyName;
      
      // Expand the Underwriting Information submenu by default
      const uwInfoSubmenu = document.getElementById('uwInfo');
      uwInfoSubmenu.style.display = 'flex';
      const uwInfoItem = document.querySelector('.nav-item[data-target="uwInfo"]');
      const arrow = uwInfoItem.querySelector('span:last-child');
      if (arrow) arrow.textContent = '▾';
      
      // Load dashboard with "Back to Company View" button
      loadScreenWithCompanyReturn('uwDetails', companyName);
    }
    
    // Modified screen loading function with company return button
    function loadScreenWithCompanyReturn(screen, companyName) {
      const main = document.getElementById('mainContent');
      main.innerHTML = '';
      
      // Add "Back to Company View" button container
      const headerContainer = document.createElement('div');
      headerContainer.className = 'company-header';
      headerContainer.style.marginBottom = '1.5rem';
      
      // Create Back button
      const backButton = document.createElement('button');
      backButton.className = 'start-uw-btn';
      backButton.style.marginLeft = 'auto';
      backButton.style.display = 'block';
      backButton.textContent = 'Back to Company View';
      backButton.addEventListener('click', () => {
        returnToCompanyView(companyName);
      });
      
      headerContainer.appendChild(backButton);
      main.appendChild(headerContainer);
      
      // Load the actual screen content
      if (screen === 'getStarted') {
        renderNewUnderwriting(main, true); // Pass true to indicate we're adding to existing content
      } else if (screen === 'uwDetails') {
        renderUWDetails(main, companyName);
      } else if (screen === 'plLabeling') {
        renderPLLabeling(main);
      } else if (screen === 'bsLabeling') {
        renderBSLabeling(main);
      } else if (screen === 'bankLabeling') {
        renderBankLabeling(main);
      } else if (screen === 'spendBanking') {
        renderSpendBanking(main, companyName);
      } else if (screen === 'spendParker') {
        renderSpendParker(main, companyName);
      } else if (screen === 'dataGathering') {
        renderDataGathering(main, companyName);
      } else if (screen === 'scoring') {
        renderScoring(main);
      } else if (screen === 'graphsMetrics') {
        renderGraphsMetrics(main);
      } else {
        const h = document.createElement('h1');
        h.textContent = screen.replace(/([A-Z])/g, ' $1');
        h.style.fontSize = '1.25rem';
        main.appendChild(h);
      }
    }
    
    /******************** UNDERWRITING DETAILS RENDERER *************************/
    function renderUWDetails(container, companyName) {
      const contentDiv = document.createElement('div');
      contentDiv.innerHTML = `
        <h1>Underwriting Information</h1>
        <div class="info-section">
          <div class="info-grid">
            <div class="info-item">
              <div class="info-item-label">Company Name</div>
              <div class="info-item-value">${companyName}</div>
            </div>
            <div class="info-item">
              <div class="info-item-label">Underwriting ID</div>
              <div class="info-item-value">UW-${new Date().getFullYear()}-${Math.floor(1000 + Math.random() * 9000)}</div>
            </div>
            <div class="info-item">
              <div class="info-item-label">Start Date</div>
              <div class="info-item-value">${new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</div>
            </div>
            <div class="info-item">
              <div class="info-item-label">Status</div>
              <div class="info-item-value"><span class="tag tag-status">In Progress</span></div>
            </div>
            <div class="info-item">
              <div class="info-item-label">Underwriter</div>
              <div class="info-item-value">Sarah Johnson</div>
            </div>
            <div class="info-item">
              <div class="info-item-label">Reviewer</div>
              <div class="info-item-value">Michael Chen</div>
            </div>
            <div class="info-item">
              <div class="info-item-label">Expected Completion</div>
              <div class="info-item-value">${new Date(Date.now() + 7 * 24 * 60 * 60 * 1000).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</div>
            </div>
            <div class="info-item">
              <div class="info-item-label">Priority</div>
              <div class="info-item-value">Medium</div>
            </div>
          </div>
        </div>
        
        <div class="info-section">
          <h2>Underwriting Progress</h2>
          <div style="background: var(--panel); border-radius: 8px; padding: 1.5rem; margin-top: 1rem;">
            <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
              <span>Data Gathering</span>
              <span>0%</span>
            </div>
            <div style="width: 100%; height: 8px; background: var(--border); border-radius: 4px; margin-bottom: 1rem;">
              <div style="width: 0%; height: 100%; background: var(--accent); border-radius: 4px;"></div>
            </div>
            
            <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
              <span>Labeling & Metrics</span>
              <span>0%</span>
            </div>
            <div style="width: 100%; height: 8px; background: var(--border); border-radius: 4px; margin-bottom: 1rem;">
              <div style="width: 0%; height: 100%; background: var(--accent); border-radius: 4px;"></div>
            </div>
            
            <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
              <span>Spend Analysis</span>
              <span>0%</span>
            </div>
            <div style="width: 100%; height: 8px; background: var(--border); border-radius: 4px; margin-bottom: 1rem;">
              <div style="width: 0%; height: 100%; background: var(--accent); border-radius: 4px;"></div>
            </div>
            
            <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
              <span>Scoring</span>
              <span>0%</span>
            </div>
            <div style="width: 100%; height: 8px; background: var(--border); border-radius: 4px; margin-bottom: 1rem;">
              <div style="width: 0%; height: 100%; background: var(--accent); border-radius: 4px;"></div>
            </div>
            
            <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
              <span>Decision Making</span>
              <span>0%</span>
            </div>
            <div style="width: 100%; height: 8px; background: var(--border); border-radius: 4px;">
              <div style="width: 0%; height: 100%; background: var(--accent); border-radius: 4px;"></div>
            </div>
          </div>
        </div>
      `;
      container.appendChild(contentDiv);
    }

    // Function to return to company view
    function returnToCompanyView(companyName) {
      // Hide UW sidebar
      document.getElementById('navSidebar').style.display = 'none';
      
      // Show company overview sidebar
      document.getElementById('companyOverviewSidebar').style.display = 'flex';
      
      // Render company overview
      renderCompanyOverview(companyName);
    }
    
    // Function to go back to the underwriting list
    function goBackToList() {
      // Hide navigation sidebars
      document.getElementById('navSidebar').style.display = 'none';
      document.getElementById('companyOverviewSidebar').style.display = 'none';
      
      // Show underwriting list
      const main = document.getElementById('mainContent');
      main.innerHTML = ''; // Ensure main content is completely clear
      renderUnderwritingList(main);
    }

    /******************** NEW UNDERWRITING RENDERER *************************/
    function renderNewUnderwriting(container, addingToExisting) {
      // If we're adding to existing content, don't clear the container
      if (!addingToExisting) {
        container.innerHTML = '';
      }
      
      const contentDiv = document.createElement('div');
      contentDiv.innerHTML = `<h1>New Underwriting</h1><div class="grid"><div class="card"><h3>Credit</h3><div class="small">Credit Available</div><div class="metric">$212,935.87</div><div class="small" style="margin-top:1rem">Utilization</div><div class="metric" style="font-size:1.25rem">54.8%</div></div><div class="card"><h3>Banking</h3><div class="small">Cash Balance</div><div class="metric">$5,043</div></div><div class="card"><h3>Insights</h3><div class="small">Net Sales</div><div class="metric">$20,124</div><div class="small" style="margin-top:1rem">Contribution Profit</div><div class="metric" style="font-size:1.25rem">$7,217</div></div><div class="card" style="grid-column:span 2"><h3>Float: Daily Cash Boost</h3><div class="metric" style="margin-bottom:0.75rem">$172,398</div><canvas id="uwFloatChart"></canvas></div><div class="card"><h3>Rewards</h3><div class="small">Points Balance</div><div class="metric">984,052</div><a href="#" style="color:var(--accent); font-size:0.85rem; text-decoration:underline; margin-top:0.5rem;">Redeem</a></div></div>`;
      container.appendChild(contentDiv);
      
      const ctx = document.getElementById('uwFloatChart').getContext('2d'); 
      new Chart(ctx, { 
        type: 'line', 
        data: { 
          labels: Array.from({length: 30}, (_, i) => `Day ${i+1}`), 
          datasets: [{ 
            label: 'Balance', 
            data: Array.from({length: 30}, () => Math.random()*50+150), 
            fill: true, 
            tension: 0.3 
          }, { 
            label: 'Spend', 
            data: Array.from({length: 30}, () => Math.random()*60+50), 
            tension: 0.3, 
            borderDash: [5, 5] 
          }]
        }, 
        options: { 
          responsive: true, 
          maintainAspectRatio: false, 
          plugins: { 
            legend: { 
              display: false 
            }
          }, 
          scales: { 
            x: { 
              display: false 
            }, 
            y: { 
              display: false 
            }
          }
        }
      }); 
    }

    /******************** SPEND PARKER RENDERER *************************/
    function renderSpendParker(container, companyName) {
      const contentDiv = document.createElement('div');
      contentDiv.innerHTML = `
        <h1>Parker Spend Analysis</h1>
        
        <div style="margin-bottom: 2rem;">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
            <div style="display: flex; gap: 1rem;">
          <div>
                <div style="font-weight: 500; margin-bottom: 0.5rem;">Card type:</div>
                <div style="position: relative; width: 200px;">
                  <select style="width: 100%; padding: 0.5rem; border: 1px solid var(--border); background: var(--panel); color: var(--text); border-radius: 4px;">
                    <option selected>All</option>
                    <option>Credit</option>
                    <option>Debit</option>
                  </select>
                  <div style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); color: var(--accent);">▼</div>
                </div>
          </div>
          <div>
                <div style="font-weight: 500; margin-bottom: 0.5rem;">Duration:</div>
                <div style="position: relative; width: 200px;">
                  <select style="width: 100%; padding: 0.5rem; border: 1px solid var(--border); background: var(--panel); color: var(--text); border-radius: 4px;">
                    <option selected>All</option>
                    <option>This Month</option>
                    <option>Last Month</option>
                    <option>Last 3 Months</option>
                    <option>Last 6 Months</option>
                    <option>Last Year</option>
                  </select>
                  <div style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); color: var(--accent);">▼</div>
                </div>
              </div>
              <div>
                <div style="font-weight: 500; margin-bottom: 0.5rem;">Label:</div>
                <div style="position: relative; width: 200px;">
                  <select style="width: 100%; padding: 0.5rem; border: 1px solid var(--border); background: var(--panel); color: var(--text); border-radius: 4px;">
                    <option selected>All</option>
                    <option>Business</option>
                    <option>Personal</option>
                    <option>Travel</option>
                    <option>Meals</option>
                    <option>Software</option>
                  </select>
                  <div style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); color: var(--accent);">▼</div>
                </div>
              </div>
            </div>
            <div>
              <div style="font-weight: 500; margin-bottom: 0.5rem;">Dates:</div>
              <div style="display: flex; gap: 0.5rem;">
                <input type="text" value="2/1/2024" style="width: 120px; padding: 0.5rem; border: 1px solid var(--border); background: var(--panel); color: var(--text); border-radius: 4px;">
                <input type="text" value="3/1/2025" style="width: 120px; padding: 0.5rem; border: 1px solid var(--border); background: var(--panel); color: var(--text); border-radius: 4px;">
              </div>
            </div>
          </div>
        </div>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 2rem;">
          <div style="position: relative; height: 400px; border: 1px solid var(--border); border-radius: 8px; padding: 1rem; background: var(--bg);">
            <h2 style="font-size: 1.1rem; margin-bottom: 1rem; color: var(--muted);">Parker Spend - by label</h2>
            <canvas id="spendByLabelChart"></canvas>
          </div>
          <div style="position: relative; height: 400px; border: 1px solid var(--border); border-radius: 8px; padding: 1rem; background: var(--bg);">
            <h2 style="font-size: 1.1rem; margin-bottom: 1rem; color: var(--muted);">Parker Spend - by type</h2>
            <canvas id="spendByTypeChart"></canvas>
          </div>
        </div>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 2rem;">
          <div style="position: relative; height: 400px; border: 1px solid var(--border); border-radius: 8px; padding: 1rem; background: var(--bg);">
            <h2 style="font-size: 1.1rem; margin-bottom: 1rem; color: var(--muted);">Parker Spend - by top 20 merchants</h2>
            <canvas id="spendByMerchantChart"></canvas>
          </div>
          <div style="position: relative; height: 400px; border: 1px solid var(--border); border-radius: 8px; padding: 1rem; background: var(--bg);">
            <h2 style="font-size: 1.1rem; margin-bottom: 1rem; color: var(--muted);">Parker Spend - by duration</h2>
            <canvas id="spendByDurationChart"></canvas>
          </div>
        </div>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 2rem;">
          <div style="position: relative; height: 400px; border: 1px solid var(--border); border-radius: 8px; padding: 1rem; background: var(--bg);">
            <h2 style="font-size: 1.1rem; margin-bottom: 1rem; color: var(--muted);">Utilization Trends</h2>
            <canvas id="utilizationTrendsChart"></canvas>
          </div>
          <div style="position: relative; height: 400px; border: 1px solid var(--border); border-radius: 8px; padding: 1rem; background: var(--bg);">
            <h2 style="font-size: 1.1rem; margin-bottom: 1rem; color: var(--muted);">Limit vs Balance</h2>
            <canvas id="limitVsBalanceChart"></canvas>
          </div>
        </div>
        
        <div style="margin-top: 2rem; border: 1px solid var(--border); border-radius: 8px; overflow: hidden;">
          <table style="width: 100%; border-collapse: collapse; font-size: 0.85rem;">
            <thead>
              <tr style="background: var(--panel); border-bottom: 1px solid var(--border);">
                <th style="padding: 0.75rem; text-align: left; position: sticky; top: 0; background: var(--panel); z-index: 10;">SUM</th>
                <th style="padding: 0.75rem; text-align: left; position: sticky; top: 0; background: var(--panel); z-index: 10;">Merchant / transaction detail</th>
                <th style="padding: 0.75rem; text-align: left; position: sticky; top: 0; background: var(--panel); z-index: 10;">2024-02-01</th>
                <th style="padding: 0.75rem; text-align: left; position: sticky; top: 0; background: var(--panel); z-index: 10;">2024-03-01</th>
                <th style="padding: 0.75rem; text-align: left; position: sticky; top: 0; background: var(--panel); z-index: 10;">2024-04-01</th>
                <th style="padding: 0.75rem; text-align: left; position: sticky; top: 0; background: var(--panel); z-index: 10;">2024-05-01</th>
                <th style="padding: 0.75rem; text-align: left; position: sticky; top: 0; background: var(--panel); z-index: 10;">2024-06-01</th>
              </tr>
            </thead>
            <tbody>
              <tr style="border-bottom: 1px solid var(--border);">
                <td style="padding: 0.75rem;">803,078</td>
                <td style="padding: 0.75rem;">Amazon</td>
                <td style="padding: 0.75rem; background: rgba(0, 255, 0, 0.1);">52,218</td>
                <td style="padding: 0.75rem; background: rgba(0, 255, 0, 0.1);">73,430</td>
                <td style="padding: 0.75rem;">44,256</td>
                <td style="padding: 0.75rem;">55,358</td>
                <td style="padding: 0.75rem;">48,616</td>
              </tr>
              <tr style="border-bottom: 1px solid var(--border);">
                <td style="padding: 0.75rem;">164,285</td>
                <td style="padding: 0.75rem;">Marketing Svcs</td>
                <td style="padding: 0.75rem;">8,749</td>
                <td style="padding: 0.75rem;">7,901</td>
                <td style="padding: 0.75rem;">8,502</td>
                <td style="padding: 0.75rem;">11,705</td>
                <td style="padding: 0.75rem;">13,991</td>
              </tr>
              <tr style="border-bottom: 1px solid var(--border);">
                <td style="padding: 0.75rem;">52,850</td>
                <td style="padding: 0.75rem;">Upwork</td>
                <td style="padding: 0.75rem;">-</td>
                <td style="padding: 0.75rem;">13,817</td>
                <td style="padding: 0.75rem;">-</td>
                <td style="padding: 0.75rem;">-</td>
                <td style="padding: 0.75rem;">13,456</td>
              </tr>
              <tr style="border-bottom: 1px solid var(--border);">
                <td style="padding: 0.75rem;">36,897</td>
                <td style="padding: 0.75rem;">Upwork</td>
                <td style="padding: 0.75rem;">4,191</td>
                <td style="padding: 0.75rem;">3,798</td>
                <td style="padding: 0.75rem;">3,790</td>
                <td style="padding: 0.75rem;">3,290</td>
                <td style="padding: 0.75rem;">2,705</td>
              </tr>
              <tr style="border-bottom: 1px solid var(--border);">
                <td style="padding: 0.75rem;">33,414</td>
                <td style="padding: 0.75rem;">Google</td>
                <td style="padding: 0.75rem;">1,682</td>
                <td style="padding: 0.75rem;">3,446</td>
                <td style="padding: 0.75rem;">2,895</td>
                <td style="padding: 0.75rem;">2,902</td>
                <td style="padding: 0.75rem;">3,861</td>
              </tr>
            </tbody>
          </table>
        </div>
      `;
      container.appendChild(contentDiv);
      
      // Create charts
      setTimeout(() => {
        createSpendByLabelChart();
        createSpendByTypeChart();
        createSpendByMerchantChart();
        createSpendByDurationChart();
        createUtilizationTrendsChart();
        createLimitVsBalanceChart();
      }, 100);
    }
    
    function createSpendByLabelChart() {
      const ctx = document.getElementById('spendByLabelChart').getContext('2d');
      
      // Generate quarters for labels
      const quarters = [
        '2023-Q3', '2023-Q4', '2024-Q1', '2024-Q2', '2024-Q3', '2024-Q4', 
        '2024-Q5', '2024-Q6', '2024-Q7', '2024-Q8', '2024-Q9', '2024-Q10',
        '2024-Q11', '2024-Q12', '2025-Q1'
      ];
      
      // Mock data with specific values to match screenshot
      const data = [
        89395, 117543, 74696, 88861, 81595, 121135, 98432, 106669, 
        142849, 103539, 84851, 111108, 87951
      ];
      
      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: quarters,
          datasets: [{
            label: 'Spend by Label',
            data: data,
            backgroundColor: '#f8ac59',
            barPercentage: 0.6
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            x: {
              grid: {
                display: false
              }
            },
            y: {
              grid: {
                color: 'rgba(255, 255, 255, 0.1)'
              },
              ticks: {
                callback: function(value) {
                  if (value === 0) return '0';
                  return value.toLocaleString();
                }
              }
            }
          },
          plugins: {
            legend: {
              display: false
            },
            datalabels: {
              align: 'top',
              anchor: 'end',
              color: 'white',
              formatter: function(value) {
                return value.toLocaleString();
              }
            }
          }
        }
      });
    }
    
    function createSpendByTypeChart() {
      const ctx = document.getElementById('spendByTypeChart').getContext('2d');
      
      // Generate months for labels
      const months = [];
      for (let i = 0; i < 13; i++) {
        const date = new Date(2023, 9 + i, 1);
        months.push(date.toLocaleDateString('en-US', { month: 'short', year: '2-digit' }));
      }
      
      // Create data for ACH Pay and Card
      const achPayData = months.map(() => 20);
      const cardData = months.map(() => 80);
      
      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: months,
          datasets: [
            {
              label: 'ACH Pay',
              data: achPayData,
              backgroundColor: '#dd4b39',
              stack: 'Stack 0'
            },
            {
              label: 'Card',
              data: cardData,
              backgroundColor: '#1c84c6',
              stack: 'Stack 0'
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            x: {
              stacked: true,
              grid: {
                display: false
              }
            },
            y: {
              stacked: true,
              min: 0,
              max: 100,
              grid: {
                color: 'rgba(255, 255, 255, 0.1)'
              },
              ticks: {
                callback: function(value) {
                  return value + '%';
                }
              }
            }
          },
          plugins: {
            legend: {
              position: 'top',
              labels: {
                boxWidth: 12,
                padding: 10,
                font: {
                  size: 10
                }
              }
            }
          }
        }
      });
    }
    
    function createSpendByMerchantChart() {
      const ctx = document.getElementById('spendByMerchantChart').getContext('2d');
      
      // Generate quarters for labels
      const quarters = [
        '2023-Q3', '2023-Q4', '2024-Q1', '2024-Q2', '2024-Q3', '2024-Q4', 
        '2024-Q5', '2024-Q6', '2024-Q7', '2024-Q8', '2024-Q9', '2024-Q10',
        '2024-Q11', '2024-Q12', '2025-Q1'
      ];
      
      // Generate datasets for top merchants
      const amazonData = quarters.map(() => Math.random() * 60000 + 20000);
      const marketingData = quarters.map(() => Math.random() * 15000 + 5000);
      const upworkData = quarters.map(() => Math.random() * 10000 + 5000);
      const googleData = quarters.map(() => Math.random() * 8000 + 2000);
      const metaData = quarters.map(() => Math.random() * 5000 + 1000);
      const othersData = quarters.map(() => Math.random() * 15000 + 5000);
      
      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: quarters,
          datasets: [
            {
              label: 'Amazon',
              data: amazonData,
              backgroundColor: '#1c84c6',
              stack: 'Stack 0'
            },
            {
              label: 'Marketing Svcs',
              data: marketingData,
              backgroundColor: '#f8ac59',
              stack: 'Stack 0'
            },
            {
              label: 'Upwork',
              data: upworkData,
              backgroundColor: '#1ab394',
              stack: 'Stack 0'
            },
            {
              label: 'Google',
              data: googleData,
              backgroundColor: '#ed5565',
              stack: 'Stack 0'
            },
            {
              label: 'Meta',
              data: metaData,
              backgroundColor: '#23c6c8',
              stack: 'Stack 0'
            },
            {
              label: 'Others',
              data: othersData,
              backgroundColor: '#ccc',
              stack: 'Stack 0'
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            x: {
              stacked: true,
              grid: {
                display: false
              }
            },
            y: {
              stacked: true,
              grid: {
                color: 'rgba(255, 255, 255, 0.1)'
              },
              ticks: {
                callback: function(value) {
                  if (value === 0) return '0';
                  return value / 1000 + 'K';
                }
              }
            }
          },
          plugins: {
            legend: {
              display: false
            }
          }
        }
      });
    }
    
    function createSpendByDurationChart() {
      const ctx = document.getElementById('spendByDurationChart').getContext('2d');
      
      // Generate months for labels
      const months = [];
      for (let i = 0; i < 13; i++) {
        const date = new Date(2023, 9 + i, 1);
        months.push(date.toLocaleDateString('en-US', { month: 'short', year: '2-digit' }));
      }
      
      // Create data for durations
      const duration1Data = months.map(() => 5);
      const duration2Data = months.map(() => 10);
      const duration3Data = months.map(() => 65);
      const duration4Data = months.map(() => 10);
      const duration5Data = months.map(() => 5);
      const duration6Data = months.map(() => 5);
      
      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: months,
          datasets: [
            {
              label: '< 30 days',
              data: duration1Data,
              backgroundColor: '#1c84c6',
              stack: 'Stack 0'
            },
            {
              label: '30-60 days',
              data: duration2Data,
              backgroundColor: '#1ab394',
              stack: 'Stack 0'
            },
            {
              label: '60-90 days',
              data: duration3Data,
              backgroundColor: '#f8ac59',
              stack: 'Stack 0'
            },
            {
              label: '90-120 days',
              data: duration4Data,
              backgroundColor: '#ed5565',
              stack: 'Stack 0'
            },
            {
              label: '120-150 days',
              data: duration5Data,
              backgroundColor: '#23c6c8',
              stack: 'Stack 0'
            },
            {
              label: '>150 days',
              data: duration6Data,
              backgroundColor: '#ccc',
              stack: 'Stack 0'
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            x: {
              stacked: true,
              grid: {
                display: false
              }
            },
            y: {
              stacked: true,
              grid: {
                color: 'rgba(255, 255, 255, 0.1)'
              },
              ticks: {
                callback: function(value) {
                  return value + '%';
                }
              }
            }
          },
          plugins: {
            legend: {
              position: 'top',
              labels: {
                boxWidth: 12,
                padding: 10,
                font: {
                  size: 10
                }
              }
            }
          }
        }
      });
    }
    
    function createUtilizationTrendsChart() {
      const ctx = document.getElementById('utilizationTrendsChart').getContext('2d');
      
      // Generate months for labels
      const months = [];
      for (let i = 0; i < 25; i++) {
        const date = new Date(2023, 0 + i, 1);
        months.push(date.toLocaleDateString('en-US', { month: 'short', year: '2-digit' }));
      }
      
      // Generate data
      const avgMargin = [11.2, 11.7, 13.2, 20.0, 21.3, 25.0, 28.6, 29.6, 32.5, 37.1, 40.1, 42.4, 52.4, 52.9, 56.1, 59.0, 59.3, 60.6, 63.5, 60.6, 56.7, 51.2, 51.0, 50.9, 52.5];
      const pinInflow = [19.7, 18.8, 16.6, 16, 15.2, 16.1, 19.2, 21.1, 22.3, 24.1, 27.6, 31.9, 35.3, 37.1, 38.5, 39.6, 40.3, 41.7, 43.1, 43.9, 41.5, 40.9, 39.9, 38.8, 38.0];
      
      new Chart(ctx, {
        type: 'line',
        data: {
          labels: months,
          datasets: [
            {
              label: 'Gross Margin %',
              data: avgMargin,
              fill: false,
              borderColor: '#ed5565',
              backgroundColor: '#ed5565',
              tension: 0.4
            },
            {
              label: 'Pin Inflow %',
              data: pinInflow,
              fill: false,
              borderColor: '#1c84c6',
              backgroundColor: '#1c84c6',
              tension: 0.4
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            x: {
              grid: {
                display: false
              }
            },
            y: {
              min: 0,
              max: 80,
              grid: {
                color: 'rgba(255, 255, 255, 0.1)'
              },
              ticks: {
                callback: function(value) {
                  return value + '%';
                }
              }
            }
          },
          plugins: {
            legend: {
              position: 'top',
              labels: {
                boxWidth: 12,
                padding: 10,
                font: {
                  size: 10
                }
              }
            }
          }
        }
      });
    }
    
    function createLimitVsBalanceChart() {
      const ctx = document.getElementById('limitVsBalanceChart').getContext('2d');
      
      // Generate days for labels (60 days)
      const days = [];
      for (let i = 0; i < 60; i++) {
        days.push(i + 1);
      }
      
      // Generate data
      const limitData = Array(days.length).fill(250000);
      
      // Create fluctuating balance data
      const balanceData = [];
      let balance = 180000;
      for (let i = 0; i < days.length; i++) {
        balance += (Math.random() - 0.48) * 10000;
        balance = Math.max(100000, Math.min(250000, balance));
        balanceData.push(balance);
      }
      
      new Chart(ctx, {
        type: 'line',
        data: {
          labels: days,
          datasets: [
            {
              label: 'Limit',
              data: limitData,
              borderColor: '#1c84c6',
              backgroundColor: '#1c84c6',
              borderWidth: 2,
              pointRadius: 0
            },
            {
              label: 'Balance',
              data: balanceData,
              borderColor: '#ed5565',
              backgroundColor: '#ed5565',
              borderWidth: 2,
              pointRadius: 0
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            x: {
              grid: {
                display: false
              }
            },
            y: {
              grid: {
                color: 'rgba(255, 255, 255, 0.1)'
              },
              ticks: {
                callback: function(value) {
                  return '$' + (value / 1000) + 'K';
                }
              }
            }
          },
          plugins: {
            legend: {
              position: 'top',
              labels: {
                boxWidth: 12,
                padding: 10,
                font: {
                  size: 10
                }
              }
            }
          }
        }
      });
    }

    /******************** STARTUP: show list first *************************/
    document.addEventListener('DOMContentLoaded',()=>{
      const main = document.getElementById('mainContent');
      renderUnderwritingList(main);
      
      // Add back button click handlers
      document.getElementById('backBtn').addEventListener('click', goBackToList);
      document.getElementById('backToListBtn').addEventListener('click', goBackToList);
      
      // Add company screen navigation click handlers
      document.querySelectorAll('.nav-item[data-company-screen]').forEach(item => {
        item.addEventListener('click', () => {
          loadCompanyScreen(item.dataset.companyScreen);
        });
      });
    });

    /******************** DATA GATHERING RENDERER *************************/
    function renderDataGathering(container, companyName) {
      const contentDiv = document.createElement('div');
      contentDiv.innerHTML = `
        <h1>Data Gathering</h1>
        
        <div style="display: grid; grid-template-columns: 1fr; gap: 1.5rem; margin-bottom: 2rem;">
          <!-- Source Readiness Section -->
          <div style="border: 1px solid var(--border); border-radius: 8px; padding: 1.5rem; background: var(--bg);">
            <h2 style="font-size: 1.2rem; margin-bottom: 1rem; font-weight: 500;">Source Readiness</h2>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1rem; margin-bottom: 1.5rem;">
              <div style="background: var(--panel); border-radius: 8px; padding: 1.25rem; position: relative;">
                <h3 style="font-size: 1rem; margin-bottom: 0.75rem; color: var(--muted);">Banking Data</h3>
                <div style="font-size: 1.75rem; font-weight: 600; margin-bottom: 0.5rem; color: #1ab394;">Connected</div>
                <div style="font-size: 0.85rem; color: var(--muted);">Last update: Today, 09:24 AM</div>
                <div style="position: absolute; top: 1.25rem; right: 1.25rem;">
                  <span style="display: inline-block; width: 36px; height: 36px; background-color: rgba(26, 179, 148, 0.25); border-radius: 50%; text-align: center; line-height: 36px;">
                    <span style="color: #1ab394; font-size: 18px;">✓</span>
                  </span>
                </div>
              </div>
              
              <div style="background: var(--panel); border-radius: 8px; padding: 1.25rem; position: relative;">
                <h3 style="font-size: 1rem; margin-bottom: 0.75rem; color: var(--muted);">Accounting Data</h3>
                <div style="font-size: 1.75rem; font-weight: 600; margin-bottom: 0.5rem; color: #1ab394;">Connected</div>
                <div style="font-size: 0.85rem; color: var(--muted);">Last update: Today, 08:15 AM</div>
                <div style="position: absolute; top: 1.25rem; right: 1.25rem;">
                  <span style="display: inline-block; width: 36px; height: 36px; background-color: rgba(26, 179, 148, 0.25); border-radius: 50%; text-align: center; line-height: 36px;">
                    <span style="color: #1ab394; font-size: 18px;">✓</span>
                  </span>
                </div>
              </div>
              
              <div style="background: var(--panel); border-radius: 8px; padding: 1.25rem; position: relative;">
                <h3 style="font-size: 1rem; margin-bottom: 0.75rem; color: var(--muted);">Payment Processor</h3>
                <div style="font-size: 1.75rem; font-weight: 600; margin-bottom: 0.5rem; color: #1ab394;">Connected</div>
                <div style="font-size: 0.85rem; color: var(--muted);">Last update: Yesterday, 11:30 PM</div>
                <div style="position: absolute; top: 1.25rem; right: 1.25rem;">
                  <span style="display: inline-block; width: 36px; height: 36px; background-color: rgba(26, 179, 148, 0.25); border-radius: 50%; text-align: center; line-height: 36px;">
                    <span style="color: #1ab394; font-size: 18px;">✓</span>
                  </span>
                </div>
              </div>
            </div>
            
            <div style="font-size: 0.9rem; line-height: 1.5;">
              <p style="margin-bottom: 1rem;">All data sources are successfully connected and providing up-to-date information. There are no connectivity issues to address at this time.</p>
              <p>The following data sources are active:</p>
              <ul style="list-style-type: disc; margin-left: 1.5rem; margin-top: 0.5rem;">
                <li>Banking: Chase Business Complete Banking (connected via Plaid)</li>
                <li>Accounting: QuickBooks Online (direct API integration)</li>
                <li>Payment Processor: Stripe (direct API integration)</li>
              </ul>
            </div>
          </div>
          
          <!-- Source Completeness Section -->
          <div style="border: 1px solid var(--border); border-radius: 8px; padding: 1.5rem; background: var(--bg);">
            <h2 style="font-size: 1.2rem; margin-bottom: 1rem; font-weight: 500;">Source Completeness</h2>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1.5rem;">
              <div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                  <span>Banking Data Completeness</span>
                  <span>98%</span>
                </div>
                <div style="width: 100%; height: 8px; background: var(--border); border-radius: 4px; margin-bottom: 1rem;">
                  <div style="width: 98%; height: 100%; background: #1ab394; border-radius: 4px;"></div>
                </div>
                
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                  <span>Accounting Data Completeness</span>
                  <span>92%</span>
                </div>
                <div style="width: 100%; height: 8px; background: var(--border); border-radius: 4px; margin-bottom: 1rem;">
                  <div style="width: 92%; height: 100%; background: #1ab394; border-radius: 4px;"></div>
                </div>
                
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                  <span>Payment Processor Data Completeness</span>
                  <span>100%</span>
                </div>
                <div style="width: 100%; height: 8px; background: var(--border); border-radius: 4px; margin-bottom: 1rem;">
                  <div style="width: 100%; height: 100%; background: #1ab394; border-radius: 4px;"></div>
                </div>
              </div>
              
              <div style="background: var(--panel); border-radius: 8px; padding: 1.25rem;">
                <h3 style="font-size: 1rem; margin-bottom: 0.75rem; color: var(--muted);">Missing Data</h3>
                <table style="width: 100%; border-collapse: collapse; font-size: 0.85rem;">
                  <thead>
                    <tr style="border-bottom: 1px solid var(--border);">
                      <th style="text-align: left; padding: 0.5rem 0;">Data Source</th>
                      <th style="text-align: left; padding: 0.5rem 0;">Missing Elements</th>
                      <th style="text-align: left; padding: 0.5rem 0;">Impact</th>
              </tr>
                  </thead>
                  <tbody>
                    <tr style="border-bottom: 1px solid var(--border);">
                      <td style="padding: 0.5rem 0;">Banking</td>
                      <td style="padding: 0.5rem 0;">2 months historical data (2022)</td>
                      <td style="padding: 0.5rem 0;"><span style="color: #f8ac59;">Low</span></td>
                    </tr>
                    <tr style="border-bottom: 1px solid var(--border);">
                      <td style="padding: 0.5rem 0;">Accounting</td>
                      <td style="padding: 0.5rem 0;">Some expense categorizations</td>
                      <td style="padding: 0.5rem 0;"><span style="color: #f8ac59;">Medium</span></td>
                    </tr>
                    <tr>
                      <td style="padding: 0.5rem 0;">Payment Processor</td>
                      <td style="padding: 0.5rem 0;">None</td>
                      <td style="padding: 0.5rem 0;"><span style="color: #1ab394;">None</span></td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
            
            <div style="font-size: 0.9rem; line-height: 1.5;">
              <p style="margin-bottom: 1rem;">Overall data completeness is at <strong>96.67%</strong>, which exceeds the minimum threshold of 90% required for accurate analysis.</p>
              <p>The following actions are recommended to improve data completeness:</p>
              <ul style="list-style-type: disc; margin-left: 1.5rem; margin-top: 0.5rem;">
                <li>Request additional historical banking data from the client for the missing 2022 months</li>
                <li>Work with the accounting team to properly categorize remaining uncategorized expenses</li>
              </ul>
            </div>
          </div>
          
          <!-- Source Consistency Section -->
          <div style="border: 1px solid var(--border); border-radius: 8px; padding: 1.5rem; background: var(--bg);">
            <h2 style="font-size: 1.2rem; margin-bottom: 1rem; font-weight: 500;">Source Consistency</h2>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1.5rem;">
              <div style="background: var(--panel); border-radius: 8px; padding: 1.25rem;">
                <h3 style="font-size: 1rem; margin-bottom: 1rem; color: var(--muted);">Monthly Reconciliation Status</h3>
                <canvas id="reconciliationChart" height="220"></canvas>
              </div>
              
              <div style="background: var(--panel); border-radius: 8px; padding: 1.25rem;">
                <h3 style="font-size: 1rem; margin-bottom: 0.75rem; color: var(--muted);">Consistency Issues</h3>
                <table style="width: 100%; border-collapse: collapse; font-size: 0.85rem;">
                  <thead>
                    <tr style="border-bottom: 1px solid var(--border);">
                      <th style="text-align: left; padding: 0.5rem 0;">Issue Type</th>
                      <th style="text-align: left; padding: 0.5rem 0;">Count</th>
                      <th style="text-align: left; padding: 0.5rem 0;">Severity</th>
              </tr>
                  </thead>
                  <tbody>
                    <tr style="border-bottom: 1px solid var(--border);">
                      <td style="padding: 0.5rem 0;">Revenue Discrepancies</td>
                      <td style="padding: 0.5rem 0;">2</td>
                      <td style="padding: 0.5rem 0;"><span style="color: #f8ac59;">Medium</span></td>
                    </tr>
                    <tr style="border-bottom: 1px solid var(--border);">
                      <td style="padding: 0.5rem 0;">Timing Differences</td>
                      <td style="padding: 0.5rem 0;">5</td>
                      <td style="padding: 0.5rem 0;"><span style="color: #1ab394;">Low</span></td>
                    </tr>
                    <tr>
                      <td style="padding: 0.5rem 0;">Missing Transactions</td>
                      <td style="padding: 0.5rem 0;">1</td>
                      <td style="padding: 0.5rem 0;"><span style="color: #ed5565;">High</span></td>
                    </tr>
                  </tbody>
                </table>
                
                <div style="margin-top: 1.5rem;">
                  <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                    <span>Overall Consistency Score</span>
                    <span>89%</span>
                  </div>
                  <div style="width: 100%; height: 8px; background: var(--border); border-radius: 4px;">
                    <div style="width: 89%; height: 100%; background: #f8ac59; border-radius: 4px;"></div>
                  </div>
                </div>
              </div>
            </div>
            
            <div style="font-size: 0.9rem; line-height: 1.5;">
              <p style="margin-bottom: 1rem;">Data consistency across sources has a score of <strong>89%</strong>, which is slightly below the ideal threshold of 95%. The main issues are related to revenue recognition timing between accounting and payment processor systems.</p>
              <p>The following actions are recommended to improve data consistency:</p>
              <ul style="list-style-type: disc; margin-left: 1.5rem; margin-top: 0.5rem;">
                <li>Investigate the high-severity missing transaction from January 2024 ($15,230)</li>
                <li>Reconcile the revenue discrepancies between QuickBooks and Stripe for February and March 2024</li>
                <li>Document the acceptable timing differences for month-end processing</li>
              </ul>
            </div>
          </div>
        </div>
      `;
      container.appendChild(contentDiv);
      
      // Create reconciliation chart after DOM is loaded
      setTimeout(() => {
        createReconciliationChart();
      }, 100);
    }
    
    function createReconciliationChart() {
      const ctx = document.getElementById('reconciliationChart').getContext('2d');
      
      // Generate months for labels
      const months = [];
      for (let i = 0; i < 12; i++) {
        const date = new Date(2023, i, 1);
        months.push(date.toLocaleDateString('en-US', { month: 'short', year: '2-digit' }));
      }
      
      // Generate random data between 80 and 100 for reconciliation percentages
      const reconciliationData = [98, 97, 95, 92, 94, 96, 98, 99, 97, 94, 89, 91];
      
      new Chart(ctx, {
        type: 'line',
        data: {
          labels: months,
          datasets: [{
            label: 'Reconciliation %',
            data: reconciliationData,
            fill: false,
            borderColor: '#1ab394',
            backgroundColor: '#1ab394',
            tension: 0.4
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            x: {
              grid: {
                display: false
              }
            },
            y: {
              min: 80,
              max: 100,
              grid: {
                color: 'rgba(255, 255, 255, 0.1)'
              },
              ticks: {
                callback: function(value) {
                  return value + '%';
                }
              }
            }
          },
          plugins: {
            legend: {
              display: false
            }
          }
        }
      });
    }
    
    /******************** SPEND BANKING RENDERER *************************/
    function renderSpendBanking(container, companyName) {
      const contentDiv = document.createElement('div');
      contentDiv.innerHTML = `
        <h1>Banking Analysis</h1>
        
        <div style="margin-bottom: 2rem;">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
            <div>
              <div style="font-weight: 500; margin-bottom: 0.5rem;">Label:</div>
              <div style="display: flex; align-items: center;">
                <div style="width: 200px;">Transaction Merchant vs Description:</div>
                <div style="position: relative; width: 200px;">
                  <select style="width: 100%; padding: 0.5rem; border: 1px solid var(--border); background: var(--panel); color: var(--text); border-radius: 4px;">
                    <option selected>Merchant</option>
                    <option>Description</option>
                  </select>
                  <div style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); color: var(--accent);">▼</div>
                </div>
              </div>
            </div>
            <div>
              <div style="font-weight: 500; margin-bottom: 0.5rem;">Dates:</div>
              <div style="display: flex; gap: 0.5rem;">
                <input type="text" value="11/1/2023" style="width: 120px; padding: 0.5rem; border: 1px solid var(--border); background: var(--panel); color: var(--text); border-radius: 4px;">
                <input type="text" value="4/30/2025" style="width: 120px; padding: 0.5rem; border: 1px solid var(--border); background: var(--panel); color: var(--text); border-radius: 4px;">
              </div>
            </div>
          </div>
        </div>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 2rem;">
          <div style="position: relative; height: 400px; border: 1px solid var(--border); border-radius: 8px; padding: 1rem; background: var(--bg);">
            <h2 style="font-size: 1.1rem; margin-bottom: 1rem; color: var(--muted);">Banking - Cash Based P&L</h2>
            <canvas id="cashFlowChart"></canvas>
          </div>
          <div style="position: relative; height: 400px; border: 1px solid var(--border); border-radius: 8px; padding: 1rem; background: var(--bg);">
            <h2 style="font-size: 1.1rem; margin-bottom: 1rem; color: var(--muted);">Banking - Expenses</h2>
            <canvas id="expensesChart"></canvas>
          </div>
        </div>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
          <div style="position: relative; height: 400px; border: 1px solid var(--border); border-radius: 8px; padding: 1rem; background: var(--bg);">
            <h2 style="font-size: 1.1rem; margin-bottom: 1rem; color: var(--muted);">Label Selected</h2>
            <canvas id="labelSelectedChart"></canvas>
          </div>
          <div style="position: relative; height: 400px; border: 1px solid var(--border); border-radius: 8px; padding: 1rem; background: var(--bg);">
            <h2 style="font-size: 1.1rem; margin-bottom: 1rem; color: var(--muted);">Detail of label (largest 20 amounts)</h2>
            <canvas id="detailLabelChart"></canvas>
          </div>
        </div>
        
        <div style="margin-top: 2rem; border: 1px solid var(--border); border-radius: 8px; overflow: hidden;">
          <table style="width: 100%; border-collapse: collapse; font-size: 0.85rem;">
            <thead>
              <tr style="background: var(--panel); border-bottom: 1px solid var(--border);">
                <th style="padding: 0.75rem; text-align: left; position: sticky; top: 0; background: var(--panel); z-index: 10;">SUM</th>
                <th style="padding: 0.75rem; text-align: left; position: sticky; top: 0; background: var(--panel); z-index: 10;">Merchant / transaction detail</th>
                <th style="padding: 0.75rem; text-align: left; position: sticky; top: 0; background: var(--panel); z-index: 10;">2023-11-01</th>
                <th style="padding: 0.75rem; text-align: left; position: sticky; top: 0; background: var(--panel); z-index: 10;">2023-12-01</th>
                <th style="padding: 0.75rem; text-align: left; position: sticky; top: 0; background: var(--panel); z-index: 10;">2024-01-01</th>
                <th style="padding: 0.75rem; text-align: left; position: sticky; top: 0; background: var(--panel); z-index: 10;">2024-02-01</th>
                <th style="padding: 0.75rem; text-align: left; position: sticky; top: 0; background: var(--panel); z-index: 10;">2024-03-01</th>
              </tr>
            </thead>
            <tbody>
              <tr style="border-bottom: 1px solid var(--border);">
                <td style="padding: 0.75rem;">7,019,532</td>
                <td style="padding: 0.75rem;">Amazon</td>
                <td style="padding: 0.75rem;">359,440</td>
                <td style="padding: 0.75rem;">447,329</td>
                <td style="padding: 0.75rem;">358,263</td>
                <td style="padding: 0.75rem;">246,078</td>
                <td style="padding: 0.75rem;">259,732</td>
              </tr>
              <tr style="border-bottom: 1px solid var(--border);">
                <td style="padding: 0.75rem;">3,670,000</td>
                <td style="padding: 0.75rem;">Humancentric Ven</td>
                <td style="padding: 0.75rem;">810,000</td>
                <td style="padding: 0.75rem;">1,000,000</td>
                <td style="padding: 0.75rem;">930,000</td>
                <td style="padding: 0.75rem;">840,000</td>
                <td style="padding: 0.75rem;">90,000</td>
              </tr>
              <tr style="border-bottom: 1px solid var(--border);">
                <td style="padding: 0.75rem;">1,250,000</td>
                <td style="padding: 0.75rem;">Currency Cloud</td>
                <td style="padding: 0.75rem;">-</td>
                <td style="padding: 0.75rem;">-</td>
                <td style="padding: 0.75rem;">-</td>
                <td style="padding: 0.75rem;">100,000</td>
                <td style="padding: 0.75rem;">400,000</td>
              </tr>
              <tr style="border-bottom: 1px solid var(--border);">
                <td style="padding: 0.75rem;">1,096,879</td>
                <td style="padding: 0.75rem;">Kanter</td>
                <td style="padding: 0.75rem;">50,604</td>
                <td style="padding: 0.75rem;">-</td>
                <td style="padding: 0.75rem;">170,781</td>
                <td style="padding: 0.75rem;">51,520</td>
                <td style="padding: 0.75rem;">77,527</td>
              </tr>
            </tbody>
          </table>
        </div>
      `;
      container.appendChild(contentDiv);
      
      // Create charts
      setTimeout(() => {
        createCashFlowChart();
        createExpensesChart();
        createLabelSelectedChart();
        createDetailLabelChart();
      }, 100);
    }
    
    function createCashFlowChart() {
      const ctx = document.getElementById('cashFlowChart').getContext('2d');
      
      // Generate months for labels
      const months = [];
      for (let i = 0; i < 18; i++) {
        const date = new Date(2023, 3 + i, 1);
        months.push(date.toLocaleDateString('en-US', { month: 'short', year: '2-digit' }));
      }
      
      // Generate random data
      const revenueData = months.map(() => Math.random() * 200000);
      const specialInflowsData = months.map(() => Math.random() * 100000);
      const equityData = months.map(() => Math.random() * 150000);
      const debtInvestmentData = months.map(() => Math.random() * -150000);
      const specialOutflowsData = months.map(() => Math.random() * -100000);
      const reconciledIntrasCompanyData = months.map(() => Math.random() * 150000);
      const unreconciledIntrasCompanyData = months.map(() => Math.random() * 120000);
      const debtRepaymentData = months.map(() => Math.random() * -100000);
      const investmentData = months.map(() => Math.random() * -120000);
      const totalExpensesData = months.map(() => Math.random() * -200000);
      
      // Generate line data (total and operating cashflow)
      const totalCashflowData = months.map(() => Math.random() * 200000 - 100000);
      const operatingCashflowData = months.map(() => Math.random() * 250000 - 100000);
      
      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: months,
          datasets: [
            {
              label: 'Revenue',
              data: revenueData,
              backgroundColor: '#4a89dc',
              order: 2
            },
            {
              label: 'Special inflows',
              data: specialInflowsData,
              backgroundColor: '#5d9cec',
              order: 2
            },
            {
              label: 'Equity',
              data: equityData,
              backgroundColor: '#a0d468',
              order: 2
            },
            {
              label: 'Debt Investment',
              data: debtInvestmentData,
              backgroundColor: '#da4453',
              order: 2
            },
            {
              label: 'Special outflows',
              data: specialOutflowsData,
              backgroundColor: '#ed5565',
              order: 2
            },
            {
              label: 'Reconciled Intra company',
              data: reconciledIntrasCompanyData,
              backgroundColor: '#8cc152',
              order: 2
            },
            {
              label: 'Unreconciled Intra company',
              data: unreconciledIntrasCompanyData,
              backgroundColor: '#ccd1d9',
              order: 2
            },
            {
              label: 'Debt Repayment',
              data: debtRepaymentData,
              backgroundColor: '#fc6e51',
              order: 2
            },
            {
              label: 'Investment',
              data: investmentData,
              backgroundColor: '#f6bb42',
              order: 2
            },
            {
              label: 'Total Expenses',
              data: totalExpensesData,
              backgroundColor: '#37bc9b',
              order: 2
            },
            {
              label: 'Total Cashflow',
              data: totalCashflowData,
              type: 'line',
              borderColor: '#000',
              borderWidth: 2,
              pointRadius: 0,
              borderDash: [5, 5],
              fill: false,
              order: 1
            },
            {
              label: 'Op. Cashflow',
              data: operatingCashflowData,
              type: 'line',
              borderColor: '#3b5bdb',
              borderWidth: 2,
              pointRadius: 0,
              fill: false,
              order: 0
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            x: {
              stacked: true,
              grid: {
                display: false
              }
            },
            y: {
              stacked: true,
              grid: {
                color: 'rgba(255, 255, 255, 0.1)'
              },
              ticks: {
                callback: function(value) {
                  if (value === 0) return '0';
                  return value / 1000 + 'K';
                }
              }
            }
          },
          plugins: {
            legend: {
              display: true,
              position: 'right',
              labels: {
                boxWidth: 12,
                padding: 10,
                font: {
                  size: 10
                }
              }
            }
          }
        }
      });
    }
    
    function createExpensesChart() {
      const ctx = document.getElementById('expensesChart').getContext('2d');
      
      // Generate months for labels
      const months = [];
      for (let i = 0; i < 18; i++) {
        const date = new Date(2023, 3 + i, 1);
        months.push(date.toLocaleDateString('en-US', { month: 'short', year: '2-digit' }));
      }
      
      // Generate random data for expense categories
      const checkDepositsData = months.map(() => Math.random() * -20000);
      const refundsData = months.map(() => Math.random() * -25000);
      const overdraftData = months.map(() => Math.random() * -15000);
      const chargesFeesData = months.map(() => Math.random() * -30000);
      const advertisingData = months.map(() => Math.random() * -40000);
      const travelData = months.map(() => Math.random() * -20000);
      const utilitiesData = months.map(() => Math.random() * -15000);
      const checkOutflowsData = months.map(() => Math.random() * -35000);
      const atmCashOutflowsData = months.map(() => Math.random() * -10000);
      const rentData = months.map(() => Math.random() * -50000);
      const p2pTransfersData = months.map(() => Math.random() * -45000);
      const softwareData = months.map(() => Math.random() * -20000);
      
      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: months,
          datasets: [
            {
              label: 'Check Deposits',
              data: checkDepositsData,
              backgroundColor: '#f5f7fa',
              order: 2
            },
            {
              label: 'Refunds',
              data: refundsData,
              backgroundColor: '#ccd1d9',
              order: 2
            },
            {
              label: 'Overdraft/NSF Fees',
              data: overdraftData,
              backgroundColor: '#f6bb42',
              order: 2
            },
            {
              label: 'Charges/Fees',
              data: chargesFeesData,
              backgroundColor: '#5d9cec',
              order: 2
            },
            {
              label: 'Advertising',
              data: advertisingData,
              backgroundColor: '#fc6e51',
              order: 2
            },
            {
              label: 'Travel',
              data: travelData,
              backgroundColor: '#a0d468',
              order: 2
            },
            {
              label: 'Utilities',
              data: utilitiesData,
              backgroundColor: '#ffce54',
              order: 2
            },
            {
              label: 'Check Outflows',
              data: checkOutflowsData,
              backgroundColor: '#ac92ec',
              order: 2
            },
            {
              label: 'ATM Cash Outflows',
              data: atmCashOutflowsData,
              backgroundColor: '#ec87c0',
              order: 2
            },
            {
              label: 'Rent',
              data: rentData,
              backgroundColor: '#48cfad',
              order: 2
            },
            {
              label: 'P2P Transfers',
              data: p2pTransfersData,
              backgroundColor: '#4fc1e9',
              order: 2
            },
            {
              label: 'Software',
              data: softwareData,
              backgroundColor: '#8cc152',
              order: 2
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            x: {
              stacked: true,
              grid: {
                display: false
              }
            },
            y: {
              stacked: true,
              grid: {
                color: 'rgba(255, 255, 255, 0.1)'
              },
              ticks: {
                callback: function(value) {
                  if (value === 0) return '0';
                  return value / 1000 + 'K';
                }
              }
            }
          },
          plugins: {
            legend: {
              display: true,
              position: 'right',
              labels: {
                boxWidth: 12,
                padding: 10,
                font: {
                  size: 10
                }
              }
            }
          }
        }
      });
    }
    
    function createLabelSelectedChart() {
      const ctx = document.getElementById('labelSelectedChart').getContext('2d');
      
      // Generate quarters for labels
      const quarters = [
        '2023-Q3', '2023-Q4', '2024-Q1', '2024-Q2', '2024-Q3', '2024-Q4', 
        '2024-Q5', '2024-Q6', '2024-Q7', '2024-Q8', '2024-Q9', '2024-Q10',
        '2024-Q11', '2024-Q12', '2025-Q1'
      ];
      
      // Mock data with specific values to match screenshot
      const data = [
        89395, 117543, 74696, 88861, 81595, 121135, 98432, 106669, 
        142849, 103539, 84851, 111108, 87951
      ];
      
      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: quarters,
          datasets: [{
            label: 'Label Selected',
            data: data,
            backgroundColor: '#4a89dc',
            barPercentage: 0.6
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            x: {
              grid: {
                display: false
              }
            },
            y: {
              grid: {
                color: 'rgba(255, 255, 255, 0.1)'
              },
              ticks: {
                callback: function(value) {
                  if (value === 0) return '0';
                  return value.toLocaleString();
                }
              }
            }
          },
          plugins: {
            legend: {
              display: false
            },
            datalabels: {
              align: 'top',
              anchor: 'end',
              color: 'white',
              formatter: function(value) {
                return value.toLocaleString();
              }
            }
          }
        }
      });
    }
    
    function createDetailLabelChart() {
      const ctx = document.getElementById('detailLabelChart').getContext('2d');
      
      // Generate quarters for labels
      const quarters = [
        '2023-11', '2023-12', '2024-01', '2024-02', '2024-03', '2024-04', 
        '2024-05', '2024-06', '2024-07', '2024-08', '2024-09', '2024-10',
        '2024-11', '2024-12', '2025-01'
      ];
      
      // Generate multiple mock datasets with specific values
      const dataset1 = quarters.map(() => Math.random() * 400000 + 100000);
      const dataset2 = quarters.map(() => Math.random() * 300000 + 100000);
      const dataset3 = quarters.map(() => Math.random() * 200000 + 50000);
      const dataset4 = quarters.map(() => Math.random() * 100000 + 50000);
      const dataset5 = quarters.map(() => Math.random() * 150000 + 50000);
      
      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: quarters,
          datasets: [
            {
              label: 'Amazon',
              data: dataset1,
              backgroundColor: '#da4453',
              stack: 'Stack 0'
            },
            {
              label: 'Humancentric',
              data: dataset2,
              backgroundColor: '#4a89dc',
              stack: 'Stack 0'
            },
            {
              label: 'Currency Cloud',
              data: dataset3,
              backgroundColor: '#f6bb42',
              stack: 'Stack 0'
            },
            {
              label: 'Kanter',
              data: dataset4,
              backgroundColor: '#8cc152',
              stack: 'Stack 0'
            },
            {
              label: 'Others',
              data: dataset5,
              backgroundColor: '#967adc',
              stack: 'Stack 0'
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            x: {
              stacked: true,
              grid: {
                display: false
              }
            },
            y: {
              stacked: true,
              grid: {
                color: 'rgba(255, 255, 255, 0.1)'
              },
              ticks: {
                callback: function(value) {
                  if (value === 0) return '0';
                  return (value / 1000000).toFixed(1) + 'M';
                }
              }
            }
          },
          plugins: {
            legend: {
              display: true,
              position: 'right',
              labels: {
                boxWidth: 12,
                padding: 8,
                font: {
                  size: 10
                }
              }
            }
          }
        }
      });
    }

    /******************** DATA GATHERING RENDERER *************************/
    function renderDataGathering(container, companyName) {
      const contentDiv = document.createElement('div');
      contentDiv.innerHTML = `
        <h1>Data Gathering</h1>
        
        <div style="display: grid; grid-template-columns: 1fr; gap: 1.5rem; margin-bottom: 2rem;">
          <!-- Source Readiness Section -->
          <div style="border: 1px solid var(--border); border-radius: 8px; padding: 1.5rem; background: var(--bg);">
            <h2 style="font-size: 1.2rem; margin-bottom: 1rem; font-weight: 500;">Source Readiness</h2>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1rem; margin-bottom: 1.5rem;">
              <div style="background: var(--panel); border-radius: 8px; padding: 1.25rem; position: relative;">
                <h3 style="font-size: 1rem; margin-bottom: 0.75rem; color: var(--muted);">Banking Data</h3>
                <div style="font-size: 1.75rem; font-weight: 600; margin-bottom: 0.5rem; color: #1ab394;">Connected</div>
                <div style="font-size: 0.85rem; color: var(--muted);">Last update: Today, 09:24 AM</div>
                <div style="position: absolute; top: 1.25rem; right: 1.25rem;">
                  <span style="display: inline-block; width: 36px; height: 36px; background-color: rgba(26, 179, 148, 0.25); border-radius: 50%; text-align: center; line-height: 36px;">
                    <span style="color: #1ab394; font-size: 18px;">✓</span>
                  </span>
                </div>
              </div>
              
              <div style="background: var(--panel); border-radius: 8px; padding: 1.25rem; position: relative;">
                <h3 style="font-size: 1rem; margin-bottom: 0.75rem; color: var(--muted);">Accounting Data</h3>
                <div style="font-size: 1.75rem; font-weight: 600; margin-bottom: 0.5rem; color: #1ab394;">Connected</div>
                <div style="font-size: 0.85rem; color: var(--muted);">Last update: Today, 08:15 AM</div>
                <div style="position: absolute; top: 1.25rem; right: 1.25rem;">
                  <span style="display: inline-block; width: 36px; height: 36px; background-color: rgba(26, 179, 148, 0.25); border-radius: 50%; text-align: center; line-height: 36px;">
                    <span style="color: #1ab394; font-size: 18px;">✓</span>
                  </span>
                </div>
              </div>
              
              <div style="background: var(--panel); border-radius: 8px; padding: 1.25rem; position: relative;">
                <h3 style="font-size: 1rem; margin-bottom: 0.75rem; color: var(--muted);">Payment Processor</h3>
                <div style="font-size: 1.75rem; font-weight: 600; margin-bottom: 0.5rem; color: #1ab394;">Connected</div>
                <div style="font-size: 0.85rem; color: var(--muted);">Last update: Yesterday, 11:30 PM</div>
                <div style="position: absolute; top: 1.25rem; right: 1.25rem;">
                  <span style="display: inline-block; width: 36px; height: 36px; background-color: rgba(26, 179, 148, 0.25); border-radius: 50%; text-align: center; line-height: 36px;">
                    <span style="color: #1ab394; font-size: 18px;">✓</span>
                  </span>
                </div>
              </div>
            </div>
            
            <div style="font-size: 0.9rem; line-height: 1.5;">
              <p style="margin-bottom: 1rem;">All data sources are successfully connected and providing up-to-date information. There are no connectivity issues to address at this time.</p>
              <p>The following data sources are active:</p>
              <ul style="list-style-type: disc; margin-left: 1.5rem; margin-top: 0.5rem;">
                <li>Banking: Chase Business Complete Banking (connected via Plaid)</li>
                <li>Accounting: QuickBooks Online (direct API integration)</li>
                <li>Payment Processor: Stripe (direct API integration)</li>
              </ul>
            </div>
          </div>
          
          <!-- Source Completeness Section -->
          <div style="border: 1px solid var(--border); border-radius: 8px; padding: 1.5rem; background: var(--bg);">
            <h2 style="font-size: 1.2rem; margin-bottom: 1rem; font-weight: 500;">Source Completeness</h2>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1.5rem;">
              <div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                  <span>Banking Data Completeness</span>
                  <span>98%</span>
                </div>
                <div style="width: 100%; height: 8px; background: var(--border); border-radius: 4px; margin-bottom: 1rem;">
                  <div style="width: 98%; height: 100%; background: #1ab394; border-radius: 4px;"></div>
                </div>
                
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                  <span>Accounting Data Completeness</span>
                  <span>92%</span>
                </div>
                <div style="width: 100%; height: 8px; background: var(--border); border-radius: 4px; margin-bottom: 1rem;">
                  <div style="width: 92%; height: 100%; background: #1ab394; border-radius: 4px;"></div>
                </div>
                
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                  <span>Payment Processor Data Completeness</span>
                  <span>100%</span>
                </div>
                <div style="width: 100%; height: 8px; background: var(--border); border-radius: 4px; margin-bottom: 1rem;">
                  <div style="width: 100%; height: 100%; background: #1ab394; border-radius: 4px;"></div>
                </div>
              </div>
              
              <div style="background: var(--panel); border-radius: 8px; padding: 1.25rem;">
                <h3 style="font-size: 1rem; margin-bottom: 0.75rem; color: var(--muted);">Missing Data</h3>
                <table style="width: 100%; border-collapse: collapse; font-size: 0.85rem;">
                  <thead>
                    <tr style="border-bottom: 1px solid var(--border);">
                      <th style="text-align: left; padding: 0.5rem 0;">Data Source</th>
                      <th style="text-align: left; padding: 0.5rem 0;">Missing Elements</th>
                      <th style="text-align: left; padding: 0.5rem 0;">Impact</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr style="border-bottom: 1px solid var(--border);">
                      <td style="padding: 0.5rem 0;">Banking</td>
                      <td style="padding: 0.5rem 0;">2 months historical data (2022)</td>
                      <td style="padding: 0.5rem 0;"><span style="color: #f8ac59;">Low</span></td>
                    </tr>
                    <tr style="border-bottom: 1px solid var(--border);">
                      <td style="padding: 0.5rem 0;">Accounting</td>
                      <td style="padding: 0.5rem 0;">Some expense categorizations</td>
                      <td style="padding: 0.5rem 0;"><span style="color: #f8ac59;">Medium</span></td>
                    </tr>
                    <tr>
                      <td style="padding: 0.5rem 0;">Payment Processor</td>
                      <td style="padding: 0.5rem 0;">None</td>
                      <td style="padding: 0.5rem 0;"><span style="color: #1ab394;">None</span></td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
            
            <div style="font-size: 0.9rem; line-height: 1.5;">
              <p style="margin-bottom: 1rem;">Overall data completeness is at <strong>96.67%</strong>, which exceeds the minimum threshold of 90% required for accurate analysis.</p>
              <p>The following actions are recommended to improve data completeness:</p>
              <ul style="list-style-type: disc; margin-left: 1.5rem; margin-top: 0.5rem;">
                <li>Request additional historical banking data from the client for the missing 2022 months</li>
                <li>Work with the accounting team to properly categorize remaining uncategorized expenses</li>
              </ul>
            </div>
          </div>
          
          <!-- Source Consistency Section -->
          <div style="border: 1px solid var(--border); border-radius: 8px; padding: 1.5rem; background: var(--bg);">
            <h2 style="font-size: 1.2rem; margin-bottom: 1rem; font-weight: 500;">Source Consistency</h2>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1.5rem;">
              <div style="background: var(--panel); border-radius: 8px; padding: 1.25rem;">
                <h3 style="font-size: 1rem; margin-bottom: 1rem; color: var(--muted);">Monthly Reconciliation Status</h3>
                <canvas id="reconciliationChart" height="220"></canvas>
              </div>
              
              <div style="background: var(--panel); border-radius: 8px; padding: 1.25rem;">
                <h3 style="font-size: 1rem; margin-bottom: 0.75rem; color: var(--muted);">Consistency Issues</h3>
                <table style="width: 100%; border-collapse: collapse; font-size: 0.85rem;">
                  <thead>
                    <tr style="border-bottom: 1px solid var(--border);">
                      <th style="text-align: left; padding: 0.5rem 0;">Issue Type</th>
                      <th style="text-align: left; padding: 0.5rem 0;">Count</th>
                      <th style="text-align: left; padding: 0.5rem 0;">Severity</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr style="border-bottom: 1px solid var(--border);">
                      <td style="padding: 0.5rem 0;">Revenue Discrepancies</td>
                      <td style="padding: 0.5rem 0;">2</td>
                      <td style="padding: 0.5rem 0;"><span style="color: #f8ac59;">Medium</span></td>
                    </tr>
                    <tr style="border-bottom: 1px solid var(--border);">
                      <td style="padding: 0.5rem 0;">Timing Differences</td>
                      <td style="padding: 0.5rem 0;">5</td>
                      <td style="padding: 0.5rem 0;"><span style="color: #1ab394;">Low</span></td>
                    </tr>
                    <tr>
                      <td style="padding: 0.5rem 0;">Missing Transactions</td>
                      <td style="padding: 0.5rem 0;">1</td>
                      <td style="padding: 0.5rem 0;"><span style="color: #ed5565;">High</span></td>
                    </tr>
                  </tbody>
                </table>
                
                <div style="margin-top: 1.5rem;">
                  <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                    <span>Overall Consistency Score</span>
                    <span>89%</span>
                  </div>
                  <div style="width: 100%; height: 8px; background: var(--border); border-radius: 4px;">
                    <div style="width: 89%; height: 100%; background: #f8ac59; border-radius: 4px;"></div>
                  </div>
                </div>
              </div>
            </div>
            
            <div style="font-size: 0.9rem; line-height: 1.5;">
              <p style="margin-bottom: 1rem;">Data consistency across sources has a score of <strong>89%</strong>, which is slightly below the ideal threshold of 95%. The main issues are related to revenue recognition timing between accounting and payment processor systems.</p>
              <p>The following actions are recommended to improve data consistency:</p>
              <ul style="list-style-type: disc; margin-left: 1.5rem; margin-top: 0.5rem;">
                <li>Investigate the high-severity missing transaction from January 2024 ($15,230)</li>
                <li>Reconcile the revenue discrepancies between QuickBooks and Stripe for February and March 2024</li>
                <li>Document the acceptable timing differences for month-end processing</li>
              </ul>
            </div>
          </div>
        </div>
      `;
      container.appendChild(contentDiv);
      
      // Create reconciliation chart after DOM is loaded
      setTimeout(() => {
        createReconciliationChart();
      }, 100);
    }
    
    function createReconciliationChart() {
      const ctx = document.getElementById('reconciliationChart').getContext('2d');
      
      // Generate months for labels
      const months = [];
      for (let i = 0; i < 12; i++) {
        const date = new Date(2023, i, 1);
        months.push(date.toLocaleDateString('en-US', { month: 'short', year: '2-digit' }));
      }
      
      // Generate random data between 80 and 100 for reconciliation percentages
      const reconciliationData = [98, 97, 95, 92, 94, 96, 98, 99, 97, 94, 89, 91];
      
      new Chart(ctx, {
        type: 'line',
        data: {
          labels: months,
          datasets: [{
            label: 'Reconciliation %',
            data: reconciliationData,
            fill: false,
            borderColor: '#1ab394',
            backgroundColor: '#1ab394',
            tension: 0.4
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            x: {
              grid: {
                display: false
              }
            },
            y: {
              min: 80,
              max: 100,
              grid: {
                color: 'rgba(255, 255, 255, 0.1)'
              },
              ticks: {
                callback: function(value) {
                  return value + '%';
                }
              }
            }
          },
          plugins: {
            legend: {
              display: false
            }
          }
        }
      });
    }
    
    /******************** SPEND BANKING RENDERER *************************/
    function renderSpendBanking(container, companyName) {
      const contentDiv = document.createElement('div');
      contentDiv.innerHTML = `
        <h1>Banking Analysis</h1>
        
        <div style="margin-bottom: 2rem;">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
            <div>
              <div style="font-weight: 500; margin-bottom: 0.5rem;">Label:</div>
              <div style="display: flex; align-items: center;">
                <div style="width: 200px;">Transaction Merchant vs Description:</div>
                <div style="position: relative; width: 200px;">
                  <select style="width: 100%; padding: 0.5rem; border: 1px solid var(--border); background: var(--panel); color: var(--text); border-radius: 4px;">
                    <option selected>Merchant</option>
                    <option>Description</option>
                  </select>
                  <div style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); color: var(--accent);">▼</div>
                </div>
              </div>
            </div>
            <div>
              <div style="font-weight: 500; margin-bottom: 0.5rem;">Dates:</div>
              <div style="display: flex; gap: 0.5rem;">
                <input type="text" value="11/1/2023" style="width: 120px; padding: 0.5rem; border: 1px solid var(--border); background: var(--panel); color: var(--text); border-radius: 4px;">
                <input type="text" value="4/30/2025" style="width: 120px; padding: 0.5rem; border: 1px solid var(--border); background: var(--panel); color: var(--text); border-radius: 4px;">
              </div>
            </div>
          </div>
        </div>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 2rem;">
          <div style="position: relative; height: 400px; border: 1px solid var(--border); border-radius: 8px; padding: 1rem; background: var(--bg);">
            <h2 style="font-size: 1.1rem; margin-bottom: 1rem; color: var(--muted);">Banking - Cash Based P&L</h2>
            <canvas id="cashFlowChart"></canvas>
          </div>
          <div style="position: relative; height: 400px; border: 1px solid var(--border); border-radius: 8px; padding: 1rem; background: var(--bg);">
            <h2 style="font-size: 1.1rem; margin-bottom: 1rem; color: var(--muted);">Banking - Expenses</h2>
            <canvas id="expensesChart"></canvas>
          </div>
        </div>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
          <div style="position: relative; height: 400px; border: 1px solid var(--border); border-radius: 8px; padding: 1rem; background: var(--bg);">
            <h2 style="font-size: 1.1rem; margin-bottom: 1rem; color: var(--muted);">Label Selected</h2>
            <canvas id="labelSelectedChart"></canvas>
          </div>
          <div style="position: relative; height: 400px; border: 1px solid var(--border); border-radius: 8px; padding: 1rem; background: var(--bg);">
            <h2 style="font-size: 1.1rem; margin-bottom: 1rem; color: var(--muted);">Detail of label (largest 20 amounts)</h2>
            <canvas id="detailLabelChart"></canvas>
          </div>
        </div>
        
        <div style="margin-top: 2rem; border: 1px solid var(--border); border-radius: 8px; overflow: hidden;">
          <table style="width: 100%; border-collapse: collapse; font-size: 0.85rem;">
            <thead>
              <tr style="background: var(--panel); border-bottom: 1px solid var(--border);">
                <th style="padding: 0.75rem; text-align: left; position: sticky; top: 0; background: var(--panel); z-index: 10;">SUM</th>
                <th style="padding: 0.75rem; text-align: left; position: sticky; top: 0; background: var(--panel); z-index: 10;">Merchant / transaction detail</th>
                <th style="padding: 0.75rem; text-align: left; position: sticky; top: 0; background: var(--panel); z-index: 10;">2023-11-01</th>
                <th style="padding: 0.75rem; text-align: left; position: sticky; top: 0; background: var(--panel); z-index: 10;">2023-12-01</th>
                <th style="padding: 0.75rem; text-align: left; position: sticky; top: 0; background: var(--panel); z-index: 10;">2024-01-01</th>
                <th style="padding: 0.75rem; text-align: left; position: sticky; top: 0; background: var(--panel); z-index: 10;">2024-02-01</th>
                <th style="padding: 0.75rem; text-align: left; position: sticky; top: 0; background: var(--panel); z-index: 10;">2024-03-01</th>
              </tr>
            </thead>
            <tbody>
              <tr style="border-bottom: 1px solid var(--border);">
                <td style="padding: 0.75rem;">7,019,532</td>
                <td style="padding: 0.75rem;">Amazon</td>
                <td style="padding: 0.75rem;">359,440</td>
                <td style="padding: 0.75rem;">447,329</td>
                <td style="padding: 0.75rem;">358,263</td>
                <td style="padding: 0.75rem;">246,078</td>
                <td style="padding: 0.75rem;">259,732</td>
              </tr>
              <tr style="border-bottom: 1px solid var(--border);">
                <td style="padding: 0.75rem;">3,670,000</td>
                <td style="padding: 0.75rem;">Humancentric Ven</td>
                <td style="padding: 0.75rem;">810,000</td>
                <td style="padding: 0.75rem;">1,000,000</td>
                <td style="padding: 0.75rem;">930,000</td>
                <td style="padding: 0.75rem;">840,000</td>
                <td style="padding: 0.75rem;">90,000</td>
              </tr>
              <tr style="border-bottom: 1px solid var(--border);">
                <td style="padding: 0.75rem;">1,250,000</td>
                <td style="padding: 0.75rem;">Currency Cloud</td>
                <td style="padding: 0.75rem;">-</td>
                <td style="padding: 0.75rem;">-</td>
                <td style="padding: 0.75rem;">-</td>
                <td style="padding: 0.75rem;">100,000</td>
                <td style="padding: 0.75rem;">400,000</td>
              </tr>
              <tr style="border-bottom: 1px solid var(--border);">
                <td style="padding: 0.75rem;">1,096,879</td>
                <td style="padding: 0.75rem;">Kanter</td>
                <td style="padding: 0.75rem;">50,604</td>
                <td style="padding: 0.75rem;">-</td>
                <td style="padding: 0.75rem;">170,781</td>
                <td style="padding: 0.75rem;">51,520</td>
                <td style="padding: 0.75rem;">77,527</td>
              </tr>
            </tbody>
          </table>
        </div>
      `;
      container.appendChild(contentDiv);
      
      // Create charts
      setTimeout(() => {
        createCashFlowChart();
        createExpensesChart();
        createLabelSelectedChart();
        createDetailLabelChart();
      }, 100);
    }
    
    function createCashFlowChart() {
      const ctx = document.getElementById('cashFlowChart').getContext('2d');
      
      // Generate months for labels
      const months = [];
      for (let i = 0; i < 18; i++) {
        const date = new Date(2023, 3 + i, 1);
        months.push(date.toLocaleDateString('en-US', { month: 'short', year: '2-digit' }));
      }
      
      // Generate random data
      const revenueData = months.map(() => Math.random() * 200000);
      const specialInflowsData = months.map(() => Math.random() * 100000);
      const equityData = months.map(() => Math.random() * 150000);
      const debtInvestmentData = months.map(() => Math.random() * -150000);
      const specialOutflowsData = months.map(() => Math.random() * -100000);
      const reconciledIntrasCompanyData = months.map(() => Math.random() * 150000);
      const unreconciledIntrasCompanyData = months.map(() => Math.random() * 120000);
      const debtRepaymentData = months.map(() => Math.random() * -100000);
      const investmentData = months.map(() => Math.random() * -120000);
      const totalExpensesData = months.map(() => Math.random() * -200000);
      
      // Generate line data (total and operating cashflow)
      const totalCashflowData = months.map(() => Math.random() * 200000 - 100000);
      const operatingCashflowData = months.map(() => Math.random() * 250000 - 100000);
      
      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: months,
          datasets: [
            {
              label: 'Revenue',
              data: revenueData,
              backgroundColor: '#4a89dc',
              order: 2
            },
            {
              label: 'Special inflows',
              data: specialInflowsData,
              backgroundColor: '#5d9cec',
              order: 2
            },
            {
              label: 'Equity',
              data: equityData,
              backgroundColor: '#a0d468',
              order: 2
            },
            {
              label: 'Debt Investment',
              data: debtInvestmentData,
              backgroundColor: '#da4453',
              order: 2
            },
            {
              label: 'Special outflows',
              data: specialOutflowsData,
              backgroundColor: '#ed5565',
              order: 2
            },
            {
              label: 'Reconciled Intra company',
              data: reconciledIntrasCompanyData,
              backgroundColor: '#8cc152',
              order: 2
            },
            {
              label: 'Unreconciled Intra company',
              data: unreconciledIntrasCompanyData,
              backgroundColor: '#ccd1d9',
              order: 2
            },
            {
              label: 'Debt Repayment',
              data: debtRepaymentData,
              backgroundColor: '#fc6e51',
              order: 2
            },
            {
              label: 'Investment',
              data: investmentData,
              backgroundColor: '#f6bb42',
              order: 2
            },
            {
              label: 'Total Expenses',
              data: totalExpensesData,
              backgroundColor: '#37bc9b',
              order: 2
            },
            {
              label: 'Total Cashflow',
              data: totalCashflowData,
              type: 'line',
              borderColor: '#000',
              borderWidth: 2,
              pointRadius: 0,
              borderDash: [5, 5],
              fill: false,
              order: 1
            },
            {
              label: 'Op. Cashflow',
              data: operatingCashflowData,
              type: 'line',
              borderColor: '#3b5bdb',
              borderWidth: 2,
              pointRadius: 0,
              fill: false,
              order: 0
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            x: {
              stacked: true,
              grid: {
                display: false
              }
            },
            y: {
              stacked: true,
              grid: {
                color: 'rgba(255, 255, 255, 0.1)'
              },
              ticks: {
                callback: function(value) {
                  if (value === 0) return '0';
                  return value / 1000 + 'K';
                }
              }
            }
          },
          plugins: {
            legend: {
              display: true,
              position: 'right',
              labels: {
                boxWidth: 12,
                padding: 10,
                font: {
                  size: 10
                }
              }
            }
          }
        }
      });
    }
    
    function createExpensesChart() {
      const ctx = document.getElementById('expensesChart').getContext('2d');
      
      // Generate months for labels
      const months = [];
      for (let i = 0; i < 18; i++) {
        const date = new Date(2023, 3 + i, 1);
        months.push(date.toLocaleDateString('en-US', { month: 'short', year: '2-digit' }));
      }
      
      // Generate random data for expense categories
      const checkDepositsData = months.map(() => Math.random() * -20000);
      const refundsData = months.map(() => Math.random() * -25000);
      const overdraftData = months.map(() => Math.random() * -15000);
      const chargesFeesData = months.map(() => Math.random() * -30000);
      const advertisingData = months.map(() => Math.random() * -40000);
      const travelData = months.map(() => Math.random() * -20000);
      const utilitiesData = months.map(() => Math.random() * -15000);
      const checkOutflowsData = months.map(() => Math.random() * -35000);
      const atmCashOutflowsData = months.map(() => Math.random() * -10000);
      const rentData = months.map(() => Math.random() * -50000);
      const p2pTransfersData = months.map(() => Math.random() * -45000);
      const softwareData = months.map(() => Math.random() * -20000);
      
      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: months,
          datasets: [
            {
              label: 'Check Deposits',
              data: checkDepositsData,
              backgroundColor: '#f5f7fa',
              order: 2
            },
            {
              label: 'Refunds',
              data: refundsData,
              backgroundColor: '#ccd1d9',
              order: 2
            },
            {
              label: 'Overdraft/NSF Fees',
              data: overdraftData,
              backgroundColor: '#f6bb42',
              order: 2
            },
            {
              label: 'Charges/Fees',
              data: chargesFeesData,
              backgroundColor: '#5d9cec',
              order: 2
            },
            {
              label: 'Advertising',
              data: advertisingData,
              backgroundColor: '#fc6e51',
              order: 2
            },
            {
              label: 'Travel',
              data: travelData,
              backgroundColor: '#a0d468',
              order: 2
            },
            {
              label: 'Utilities',
              data: utilitiesData,
              backgroundColor: '#ffce54',
              order: 2
            },
            {
              label: 'Check Outflows',
              data: checkOutflowsData,
              backgroundColor: '#ac92ec',
              order: 2
            },
            {
              label: 'ATM Cash Outflows',
              data: atmCashOutflowsData,
              backgroundColor: '#ec87c0',
              order: 2
            },
            {
              label: 'Rent',
              data: rentData,
              backgroundColor: '#48cfad',
              order: 2
            },
            {
              label: 'P2P Transfers',
              data: p2pTransfersData,
              backgroundColor: '#4fc1e9',
              order: 2
            },
            {
              label: 'Software',
              data: softwareData,
              backgroundColor: '#8cc152',
              order: 2
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            x: {
              stacked: true,
              grid: {
                display: false
              }
            },
            y: {
              stacked: true,
              grid: {
                color: 'rgba(255, 255, 255, 0.1)'
              },
              ticks: {
                callback: function(value) {
                  if (value === 0) return '0';
                  return value / 1000 + 'K';
                }
              }
            }
          },
          plugins: {
            legend: {
              display: true,
              position: 'right',
              labels: {
                boxWidth: 12,
                padding: 10,
                font: {
                  size: 10
                }
              }
            }
          }
        }
      });
    }
    
    function createLabelSelectedChart() {
      const ctx = document.getElementById('labelSelectedChart').getContext('2d');
      
      // Generate quarters for labels
      const quarters = [
        '2023-Q3', '2023-Q4', '2024-Q1', '2024-Q2', '2024-Q3', '2024-Q4', 
        '2024-Q5', '2024-Q6', '2024-Q7', '2024-Q8', '2024-Q9', '2024-Q10',
        '2024-Q11', '2024-Q12', '2025-Q1'
      ];
      
      // Mock data with specific values to match screenshot
      const data = [
        89395, 117543, 74696, 88861, 81595, 121135, 98432, 106669, 
        142849, 103539, 84851, 111108, 87951
      ];
      
      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: quarters,
          datasets: [{
            label: 'Label Selected',
            data: data,
            backgroundColor: '#4a89dc',
            barPercentage: 0.6
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            x: {
              grid: {
                display: false
              }
            },
            y: {
              grid: {
                color: 'rgba(255, 255, 255, 0.1)'
              },
              ticks: {
                callback: function(value) {
                  if (value === 0) return '0';
                  return value.toLocaleString();
                }
              }
            }
          },
          plugins: {
            legend: {
              display: false
            },
            datalabels: {
              align: 'top',
              anchor: 'end',
              color: 'white',
              formatter: function(value) {
                return value.toLocaleString();
              }
            }
          }
        }
      });
    }
    
    function createDetailLabelChart() {
      const ctx = document.getElementById('detailLabelChart').getContext('2d');
      
      // Generate quarters for labels
      const quarters = [
        '2023-11', '2023-12', '2024-01', '2024-02', '2024-03', '2024-04', 
        '2024-05', '2024-06', '2024-07', '2024-08', '2024-09', '2024-10',
        '2024-11', '2024-12', '2025-01'
      ];
      
      // Generate multiple mock datasets with specific values
      const dataset1 = quarters.map(() => Math.random() * 400000 + 100000);
      const dataset2 = quarters.map(() => Math.random() * 300000 + 100000);
      const dataset3 = quarters.map(() => Math.random() * 200000 + 50000);
      const dataset4 = quarters.map(() => Math.random() * 100000 + 50000);
      const dataset5 = quarters.map(() => Math.random() * 150000 + 50000);
      
      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: quarters,
          datasets: [
            {
              label: 'Amazon',
              data: dataset1,
              backgroundColor: '#da4453',
              stack: 'Stack 0'
            },
            {
              label: 'Humancentric',
              data: dataset2,
              backgroundColor: '#4a89dc',
              stack: 'Stack 0'
            },
            {
              label: 'Currency Cloud',
              data: dataset3,
              backgroundColor: '#f6bb42',
              stack: 'Stack 0'
            },
            {
              label: 'Kanter',
              data: dataset4,
              backgroundColor: '#8cc152',
              stack: 'Stack 0'
            },
            {
              label: 'Others',
              data: dataset5,
              backgroundColor: '#967adc',
              stack: 'Stack 0'
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            x: {
              stacked: true,
              grid: {
                display: false
              }
            },
            y: {
              stacked: true,
              grid: {
                color: 'rgba(255, 255, 255, 0.1)'
              },
              ticks: {
                callback: function(value) {
                  if (value === 0) return '0';
                  return (value / 1000000).toFixed(1) + 'M';
                }
              }
            }
          },
          plugins: {
            legend: {
              display: true,
              position: 'right',
              labels: {
                boxWidth: 12,
                padding: 8,
                font: {
                  size: 10
                }
              }
            }
          }
        }
      });
    }

    /******************** NEW: BALANCE SHEET LABELING *************************/
    function renderBSLabeling(container) {
      // Create the Balance Sheet Labeling content
      const contentDiv = document.createElement('div');
      contentDiv.innerHTML = `
        <h1>Balance Sheet Labeling</h1>
        
        <style>
           /* Main container */
           .bs-container {
             border: 1px solid var(--border);
             border-radius: 8px;
             overflow: hidden;
             background: var(--bg);
           }
           
           /* Table basics */
           .bs-table {
             width: 100%;
             border-collapse: collapse;
             font-size: 0.85rem;
           }
           .bs-table th {
             padding: 0.75rem;
             text-align: left;
             position: sticky;
             top: 0;
             background: var(--panel);
             z-index: 10;
             border-bottom: 1px solid var(--border);
           }
           .bs-table td {
             padding: 0.75rem;
             border-bottom: 1px solid var(--border);
           }
           
           /* Level 1 - Top level categories (non-movable) */
           .bs-level1 {
             font-weight: 700;
             font-size: 0.95rem;
             background: var(--panel);
             cursor: not-allowed;
           }
           .bs-level1 td:first-child {
             border-left: 3px solid var(--accent);
           }
           .bs-level1:hover {
             background: var(--panel);
           }
           
           /* Level 2 - Subcategories (non-movable) */
           .bs-level2 {
             font-weight: 600;
             background: rgba(26, 26, 26, 0.6);
             cursor: not-allowed;
           }
           .bs-level2 td:first-child {
             padding-left: 2rem !important;
             border-left: 2px solid var(--border);
           }
           .bs-level2:hover {
             background: rgba(26, 26, 26, 0.6);
           }
           
           /* Level 3 - Sub-subcategories (non-movable) */
           .bs-level3 {
             font-weight: 500;
             background: rgba(26, 26, 26, 0.4);
             cursor: not-allowed;
           }
           .bs-level3 td:first-child {
             padding-left: 3.5rem !important;
             border-left: 1px solid var(--border);
           }
           .bs-level3:hover {
             background: rgba(26, 26, 26, 0.4);
           }
           
           /* Level 4 - Line items (movable) */
           .bs-level4 {
             background: transparent;
           }
           .bs-level4 td:first-child {
             padding-left: 5rem !important;
           }
           .bs-level4.draggable {
             cursor: move;
           }
           .bs-level4.dragging {
             opacity: 0.5;
             background: rgba(255, 104, 51, 0.2);
           }
           
           /* Icons for fixed vs movable */
           .bs-fixed-icon {
             color: var(--muted);
             margin-right: 0.5rem;
             font-size: 0.8rem;
           }
           .bs-drag-icon {
             color: var(--muted);
             margin-right: 0.5rem;
             font-size: 0.8rem;
           }
           
           /* Other styles */
           .bs-actions {
             margin-bottom: 1rem;
             display: flex;
             justify-content: space-between;
           }
           .bs-button {
             background: var(--panel);
             border: 1px solid var(--border);
             color: var(--text);
             padding: 0.5rem 1rem;
             border-radius: 4px;
             cursor: pointer;
           }
           .bs-button:hover {
             background: var(--border);
           }
           .bs-button.primary {
             background: var(--accent);
             border: 1px solid var(--accent);
           }
           .bs-button.primary:hover {
             background: #ff5820;
           }
           .bs-number {
             text-align: right;
           }
           .bs-negative {
             color: #ed5565;
           }
           .bs-positive {
             color: #1ab394;
           }
           .bs-header-row {
             background: var(--panel) !important;
           }
           .dragging-over {
             border-bottom: 2px solid var(--accent);
           }
         </style>
        
        <div class="bs-actions">
          <div>
            <button class="bs-button">Reset</button>
            <button class="bs-button">Undo</button>
          </div>
          <div>
            <button class="bs-button primary">Save Changes</button>
          </div>
        </div>
        
        <div class="bs-container">
          <table class="bs-table" id="bsTable">
            <thead>
              <tr class="bs-header-row">
                <th style="width: 35%;">Category / Account</th>
                <th style="width: 9%;">1/31/2023</th>
                <th style="width: 9%;">2/28/2023</th>
                <th style="width: 9%;">3/31/2023</th>
                <th style="width: 9%;">4/30/2023</th>
                <th style="width: 9%;">5/31/2023</th>
                <th style="width: 9%;">6/30/2023</th>
                <th style="width: 11%;">7/31/2023</th>
              </tr>
            </thead>
            <tbody>
              <!-- Level 1 - Assets -->
              <tr class="bs-level1">
                <td><span class="bs-fixed-icon">📌</span>Assets</td>
                <td class="bs-number">$425,000</td>
                <td class="bs-number">$405,000</td>
                <td class="bs-number">$385,000</td>
                <td class="bs-number">$365,000</td>
                <td class="bs-number">$345,000</td>
                <td class="bs-number">$325,000</td>
                <td class="bs-number">$305,000</td>
              </tr>
              
              <!-- Level 2 - Current Assets -->
              <tr class="bs-level2">
                <td><span class="bs-fixed-icon">📌</span>Current Assets</td>
                <td class="bs-number">$225,000</td>
                <td class="bs-number">$210,000</td>
                <td class="bs-number">$195,000</td>
                <td class="bs-number">$180,000</td>
                <td class="bs-number">$165,000</td>
                <td class="bs-number">$150,000</td>
                <td class="bs-number">$135,000</td>
              </tr>
              
              <!-- Level 3 - Cash and Equivalents -->
              <tr class="bs-level3">
                <td><span class="bs-fixed-icon">📌</span>Cash and Cash Equivalents</td>
                <td class="bs-number">$100,000</td>
                <td class="bs-number">$95,000</td>
                <td class="bs-number">$90,000</td>
                <td class="bs-number">$85,000</td>
                <td class="bs-number">$80,000</td>
                <td class="bs-number">$75,000</td>
                <td class="bs-number">$70,000</td>
              </tr>
              
              <!-- Level 4 - Cash Items (draggable) -->
              <tr class="bs-level4 draggable" draggable="true">
                <td><span class="bs-drag-icon">≡</span>Checking Account</td>
                <td class="bs-number">$60,000</td>
                <td class="bs-number">$55,000</td>
                <td class="bs-number">$50,000</td>
                <td class="bs-number">$45,000</td>
                <td class="bs-number">$40,000</td>
                <td class="bs-number">$35,000</td>
                <td class="bs-number">$30,000</td>
              </tr>
              
              <tr class="bs-level4 draggable" draggable="true">
                <td><span class="bs-drag-icon">≡</span>Savings Account</td>
                <td class="bs-number">$40,000</td>
                <td class="bs-number">$40,000</td>
                <td class="bs-number">$40,000</td>
                <td class="bs-number">$40,000</td>
                <td class="bs-number">$40,000</td>
                <td class="bs-number">$40,000</td>
                <td class="bs-number">$40,000</td>
              </tr>
              
              <!-- Level 3 - Accounts Receivable -->
              <tr class="bs-level3">
                <td><span class="bs-fixed-icon">📌</span>Accounts Receivable</td>
                <td class="bs-number">$50,000</td>
                <td class="bs-number">$45,000</td>
                <td class="bs-number">$40,000</td>
                <td class="bs-number">$35,000</td>
                <td class="bs-number">$30,000</td>
                <td class="bs-number">$25,000</td>
                <td class="bs-number">$20,000</td>
              </tr>
              
              <tr class="bs-level4 draggable" draggable="true">
                <td><span class="bs-drag-icon">≡</span>Customer Receivables</td>
                <td class="bs-number">$50,000</td>
                <td class="bs-number">$45,000</td>
                <td class="bs-number">$40,000</td>
                <td class="bs-number">$35,000</td>
                <td class="bs-number">$30,000</td>
                <td class="bs-number">$25,000</td>
                <td class="bs-number">$20,000</td>
              </tr>
              
              <!-- Level 3 - Inventory -->
              <tr class="bs-level3">
                <td><span class="bs-fixed-icon">📌</span>Inventory</td>
                <td class="bs-number">$75,000</td>
                <td class="bs-number">$70,000</td>
                <td class="bs-number">$65,000</td>
                <td class="bs-number">$60,000</td>
                <td class="bs-number">$55,000</td>
                <td class="bs-number">$50,000</td>
                <td class="bs-number">$45,000</td>
              </tr>
              
              <tr class="bs-level4 draggable" draggable="true">
                <td><span class="bs-drag-icon">≡</span>Raw Materials</td>
                <td class="bs-number">$30,000</td>
                <td class="bs-number">$28,000</td>
                <td class="bs-number">$26,000</td>
                <td class="bs-number">$24,000</td>
                <td class="bs-number">$22,000</td>
                <td class="bs-number">$20,000</td>
                <td class="bs-number">$18,000</td>
              </tr>
              
              <tr class="bs-level4 draggable" draggable="true">
                <td><span class="bs-drag-icon">≡</span>Finished Goods</td>
                <td class="bs-number">$45,000</td>
                <td class="bs-number">$42,000</td>
                <td class="bs-number">$39,000</td>
                <td class="bs-number">$36,000</td>
                <td class="bs-number">$33,000</td>
                <td class="bs-number">$30,000</td>
                <td class="bs-number">$27,000</td>
              </tr>
              
              <!-- Level 2 - Non-Current Assets -->
              <tr class="bs-level2">
                <td><span class="bs-fixed-icon">📌</span>Non-Current Assets</td>
                <td class="bs-number">$200,000</td>
                <td class="bs-number">$195,000</td>
                <td class="bs-number">$190,000</td>
                <td class="bs-number">$185,000</td>
                <td class="bs-number">$180,000</td>
                <td class="bs-number">$175,000</td>
                <td class="bs-number">$170,000</td>
              </tr>
              
              <!-- Level 3 - Property, Plant, Equipment -->
              <tr class="bs-level3">
                <td><span class="bs-fixed-icon">📌</span>Property, Plant, and Equipment</td>
                <td class="bs-number">$200,000</td>
                <td class="bs-number">$195,000</td>
                <td class="bs-number">$190,000</td>
                <td class="bs-number">$185,000</td>
                <td class="bs-number">$180,000</td>
                <td class="bs-number">$175,000</td>
                <td class="bs-number">$170,000</td>
              </tr>
              
              <tr class="bs-level4 draggable" draggable="true">
                <td><span class="bs-drag-icon">≡</span>Building</td>
                <td class="bs-number">$120,000</td>
                <td class="bs-number">$118,000</td>
                <td class="bs-number">$116,000</td>
                <td class="bs-number">$114,000</td>
                <td class="bs-number">$112,000</td>
                <td class="bs-number">$110,000</td>
                <td class="bs-number">$108,000</td>
              </tr>
              
              <tr class="bs-level4 draggable" draggable="true">
                <td><span class="bs-drag-icon">≡</span>Equipment</td>
                <td class="bs-number">$80,000</td>
                <td class="bs-number">$77,000</td>
                <td class="bs-number">$74,000</td>
                <td class="bs-number">$71,000</td>
                <td class="bs-number">$68,000</td>
                <td class="bs-number">$65,000</td>
                <td class="bs-number">$62,000</td>
              </tr>
              
              <!-- Level 1 - Liabilities -->
              <tr class="bs-level1">
                <td><span class="bs-fixed-icon">📌</span>Liabilities</td>
                <td class="bs-number">$100,000</td>
                <td class="bs-number">$85,000</td>
                <td class="bs-number">$70,000</td>
                <td class="bs-number">$55,000</td>
                <td class="bs-number">$40,000</td>
                <td class="bs-number">$25,000</td>
                <td class="bs-number">$10,000</td>
              </tr>
              
              <!-- Level 2 - Current Liabilities -->
              <tr class="bs-level2">
                <td><span class="bs-fixed-icon">📌</span>Current Liabilities</td>
                <td class="bs-number">$50,000</td>
                <td class="bs-number">$40,000</td>
                <td class="bs-number">$30,000</td>
                <td class="bs-number">$20,000</td>
                <td class="bs-number">$10,000</td>
                <td class="bs-number">$5,000</td>
                <td class="bs-number">$0</td>
              </tr>
              
              <!-- Level 3 - Accounts Payable -->
              <tr class="bs-level3">
                <td><span class="bs-fixed-icon">📌</span>Accounts Payable</td>
                <td class="bs-number">$30,000</td>
                <td class="bs-number">$25,000</td>
                <td class="bs-number">$20,000</td>
                <td class="bs-number">$15,000</td>
                <td class="bs-number">$10,000</td>
                <td class="bs-number">$5,000</td>
                <td class="bs-number">$0</td>
              </tr>
              
              <tr class="bs-level4 draggable" draggable="true">
                <td><span class="bs-drag-icon">≡</span>Supplier Payables</td>
                <td class="bs-number">$30,000</td>
                <td class="bs-number">$25,000</td>
                <td class="bs-number">$20,000</td>
                <td class="bs-number">$15,000</td>
                <td class="bs-number">$10,000</td>
                <td class="bs-number">$5,000</td>
                <td class="bs-number">$0</td>
              </tr>
              
              <!-- Level 3 - Short-term Debt -->
              <tr class="bs-level3">
                <td><span class="bs-fixed-icon">📌</span>Short-Term Debt</td>
                <td class="bs-number">$20,000</td>
                <td class="bs-number">$15,000</td>
                <td class="bs-number">$10,000</td>
                <td class="bs-number">$5,000</td>
                <td class="bs-number">$0</td>
                <td class="bs-number">$0</td>
                <td class="bs-number">$0</td>
              </tr>
              
              <tr class="bs-level4 draggable" draggable="true">
                <td><span class="bs-drag-icon">≡</span>Credit Line</td>
                <td class="bs-number">$20,000</td>
                <td class="bs-number">$15,000</td>
                <td class="bs-number">$10,000</td>
                <td class="bs-number">$5,000</td>
                <td class="bs-number">$0</td>
                <td class="bs-number">$0</td>
                <td class="bs-number">$0</td>
              </tr>
              
              <!-- Level 2 - Non-Current Liabilities -->
              <tr class="bs-level2">
                <td><span class="bs-fixed-icon">📌</span>Non-Current Liabilities</td>
                <td class="bs-number">$50,000</td>
                <td class="bs-number">$45,000</td>
                <td class="bs-number">$40,000</td>
                <td class="bs-number">$35,000</td>
                <td class="bs-number">$30,000</td>
                <td class="bs-number">$25,000</td>
                <td class="bs-number">$20,000</td>
              </tr>
              
              <!-- Level 3 - Long-term Debt -->
              <tr class="bs-level3">
                <td><span class="bs-fixed-icon">📌</span>Long-Term Debt</td>
                <td class="bs-number">$50,000</td>
                <td class="bs-number">$45,000</td>
                <td class="bs-number">$40,000</td>
                <td class="bs-number">$35,000</td>
                <td class="bs-number">$30,000</td>
                <td class="bs-number">$25,000</td>
                <td class="bs-number">$20,000</td>
              </tr>
              
              <tr class="bs-level4 draggable" draggable="true">
                <td><span class="bs-drag-icon">≡</span>Mortgage</td>
                <td class="bs-number">$50,000</td>
                <td class="bs-number">$45,000</td>
                <td class="bs-number">$40,000</td>
                <td class="bs-number">$35,000</td>
                <td class="bs-number">$30,000</td>
                <td class="bs-number">$25,000</td>
                <td class="bs-number">$20,000</td>
              </tr>
              
              <!-- Level 1 - Equity -->
              <tr class="bs-level1">
                <td><span class="bs-fixed-icon">📌</span>Equity</td>
                <td class="bs-number">$225,000</td>
                <td class="bs-number">$220,000</td>
                <td class="bs-number">$215,000</td>
                <td class="bs-number">$210,000</td>
                <td class="bs-number">$205,000</td>
                <td class="bs-number">$200,000</td>
                <td class="bs-number">$195,000</td>
              </tr>
              
              <!-- Level 2 - Paid-in Capital -->
              <tr class="bs-level2">
                <td><span class="bs-fixed-icon">📌</span>Paid-in Capital</td>
                <td class="bs-number">$100,000</td>
                <td class="bs-number">$100,000</td>
                <td class="bs-number">$100,000</td>
                <td class="bs-number">$100,000</td>
                <td class="bs-number">$100,000</td>
                <td class="bs-number">$100,000</td>
                <td class="bs-number">$100,000</td>
              </tr>
              
              <!-- Level 3 - Common Stock -->
              <tr class="bs-level3">
                <td><span class="bs-fixed-icon">📌</span>Common Stock</td>
                <td class="bs-number">$100,000</td>
                <td class="bs-number">$100,000</td>
                <td class="bs-number">$100,000</td>
                <td class="bs-number">$100,000</td>
                <td class="bs-number">$100,000</td>
                <td class="bs-number">$100,000</td>
                <td class="bs-number">$100,000</td>
              </tr>
              
              <tr class="bs-level4 draggable" draggable="true">
                <td><span class="bs-drag-icon">≡</span>Founder Shares</td>
                <td class="bs-number">$100,000</td>
                <td class="bs-number">$100,000</td>
                <td class="bs-number">$100,000</td>
                <td class="bs-number">$100,000</td>
                <td class="bs-number">$100,000</td>
                <td class="bs-number">$100,000</td>
                <td class="bs-number">$100,000</td>
              </tr>
              
              <!-- Level 2 - Retained Earnings -->
              <tr class="bs-level2">
                <td><span class="bs-fixed-icon">📌</span>Retained Earnings</td>
                <td class="bs-number">$125,000</td>
                <td class="bs-number">$120,000</td>
                <td class="bs-number">$115,000</td>
                <td class="bs-number">$110,000</td>
                <td class="bs-number">$105,000</td>
                <td class="bs-number">$100,000</td>
                <td class="bs-number">$95,000</td>
              </tr>
              
              <tr class="bs-level3">
                <td><span class="bs-fixed-icon">📌</span>Accumulated Profit</td>
                <td class="bs-number">$125,000</td>
                <td class="bs-number">$120,000</td>
                <td class="bs-number">$115,000</td>
                <td class="bs-number">$110,000</td>
                <td class="bs-number">$105,000</td>
                <td class="bs-number">$100,000</td>
                <td class="bs-number">$95,000</td>
              </tr>
              
              <tr class="bs-level4 draggable" draggable="true">
                <td><span class="bs-drag-icon">≡</span>Current Year Earnings</td>
                <td class="bs-number">$25,000</td>
                <td class="bs-number">$20,000</td>
                <td class="bs-number">$15,000</td>
                <td class="bs-number">$10,000</td>
                <td class="bs-number">$5,000</td>
                <td class="bs-number">$0</td>
                <td class="bs-number">-$5,000</td>
              </tr>
              
              <tr class="bs-level4 draggable" draggable="true">
                <td><span class="bs-drag-icon">≡</span>Previous Years Earnings</td>
                <td class="bs-number">$100,000</td>
                <td class="bs-number">$100,000</td>
                <td class="bs-number">$100,000</td>
                <td class="bs-number">$100,000</td>
                <td class="bs-number">$100,000</td>
                <td class="bs-number">$100,000</td>
                <td class="bs-number">$100,000</td>
              </tr>
            </tbody>
          </table>
        </div>
      `;
      container.appendChild(contentDiv);
      
      // Add drag and drop functionality
      setupDragAndDrop('bsTable');
    }

    /******************** P&L LABELING RENDERER *************************/
    function renderPLLabeling(container) {
      // Create the P&L Labeling content
      const contentDiv = document.createElement('div');
      contentDiv.innerHTML = `
        <h1>Profit & Loss Labeling</h1>
        
        <div style="margin-bottom: 1rem; display: flex; justify-content: space-between;">
          <div>
            <button class="bs-button">Reset</button>
            <button class="bs-button">Undo</button>
          </div>
          <div>
            <button class="bs-button primary">Save Changes</button>
          </div>
        </div>
        
        <div class="bs-container">
          <table class="bs-table" id="plTable">
            <thead>
              <tr class="bs-header-row">
                <th style="width: 35%;">Category / Account</th>
                <th style="width: 9%;">1/31/2023</th>
                <th style="width: 9%;">2/28/2023</th>
                <th style="width: 9%;">3/31/2023</th>
                <th style="width: 9%;">4/30/2023</th>
                <th style="width: 9%;">5/31/2023</th>
                <th style="width: 9%;">6/30/2023</th>
                <th style="width: 11%;">7/31/2023</th>
              </tr>
            </thead>
            <tbody>
              <!-- Level 1 -->
              <tr class="bs-level1">
                <td><span class="bs-fixed-icon">📌</span>Revenue</td>
                <td class="bs-number">$150,000</td>
                <td class="bs-number">$160,000</td>
                <td class="bs-number">$155,000</td>
                <td class="bs-number">$165,000</td>
                <td class="bs-number">$170,000</td>
                <td class="bs-number">$175,000</td>
                <td class="bs-number">$180,000</td>
              </tr>
              
              <!-- Level 2 -->
              <tr class="bs-level2">
                <td><span class="bs-fixed-icon">📌</span>Product Revenue</td>
                <td class="bs-number">$120,000</td>
                <td class="bs-number">$130,000</td>
                <td class="bs-number">$125,000</td>
                <td class="bs-number">$135,000</td>
                <td class="bs-number">$140,000</td>
                <td class="bs-number">$145,000</td>
                <td class="bs-number">$150,000</td>
              </tr>
              
              <!-- Level 3 - Draggable items -->
              <tr class="bs-level3 draggable" draggable="true">
                <td><span class="bs-drag-icon">≡</span>Product A</td>
                <td class="bs-number">$70,000</td>
                <td class="bs-number">$75,000</td>
                <td class="bs-number">$73,000</td>
                <td class="bs-number">$77,000</td>
                <td class="bs-number">$80,000</td>
                <td class="bs-number">$83,000</td>
                <td class="bs-number">$85,000</td>
              </tr>
              
              <tr class="bs-level3 draggable" draggable="true">
                <td><span class="bs-drag-icon">≡</span>Product B</td>
                <td class="bs-number">$50,000</td>
                <td class="bs-number">$55,000</td>
                <td class="bs-number">$52,000</td>
                <td class="bs-number">$58,000</td>
                <td class="bs-number">$60,000</td>
                <td class="bs-number">$62,000</td>
                <td class="bs-number">$65,000</td>
              </tr>
              
              <!-- Level 2 -->
              <tr class="bs-level2">
                <td><span class="bs-fixed-icon">📌</span>Service Revenue</td>
                <td class="bs-number">$30,000</td>
                <td class="bs-number">$30,000</td>
                <td class="bs-number">$30,000</td>
                <td class="bs-number">$30,000</td>
                <td class="bs-number">$30,000</td>
                <td class="bs-number">$30,000</td>
                <td class="bs-number">$30,000</td>
              </tr>
              
              <tr class="bs-level3 draggable" draggable="true">
                <td><span class="bs-drag-icon">≡</span>Consulting</td>
                <td class="bs-number">$15,000</td>
                <td class="bs-number">$15,000</td>
                <td class="bs-number">$15,000</td>
                <td class="bs-number">$15,000</td>
                <td class="bs-number">$15,000</td>
                <td class="bs-number">$15,000</td>
                <td class="bs-number">$15,000</td>
              </tr>
              
              <tr class="bs-level3 draggable" draggable="true">
                <td><span class="bs-drag-icon">≡</span>Maintenance</td>
                <td class="bs-number">$15,000</td>
                <td class="bs-number">$15,000</td>
                <td class="bs-number">$15,000</td>
                <td class="bs-number">$15,000</td>
                <td class="bs-number">$15,000</td>
                <td class="bs-number">$15,000</td>
                <td class="bs-number">$15,000</td>
              </tr>
              
              <!-- Level 1 -->
              <tr class="bs-level1">
                <td><span class="bs-fixed-icon">📌</span>Expenses</td>
                <td class="bs-number">$100,000</td>
                <td class="bs-number">$105,000</td>
                <td class="bs-number">$103,000</td>
                <td class="bs-number">$107,000</td>
                <td class="bs-number">$110,000</td>
                <td class="bs-number">$112,000</td>
                <td class="bs-number">$115,000</td>
              </tr>
              
              <!-- Level 2 -->
              <tr class="bs-level2">
                <td><span class="bs-fixed-icon">📌</span>Cost of Goods Sold</td>
                <td class="bs-number">$60,000</td>
                <td class="bs-number">$63,000</td>
                <td class="bs-number">$62,000</td>
                <td class="bs-number">$64,000</td>
                <td class="bs-number">$66,000</td>
                <td class="bs-number">$67,000</td>
                <td class="bs-number">$69,000</td>
              </tr>
              
              <tr class="bs-level3 draggable" draggable="true">
                <td><span class="bs-drag-icon">≡</span>Materials</td>
                <td class="bs-number">$40,000</td>
                <td class="bs-number">$42,000</td>
                <td class="bs-number">$41,000</td>
                <td class="bs-number">$43,000</td>
                <td class="bs-number">$44,000</td>
                <td class="bs-number">$45,000</td>
                <td class="bs-number">$46,000</td>
              </tr>
              
              <tr class="bs-level3 draggable" draggable="true">
                <td><span class="bs-drag-icon">≡</span>Labor</td>
                <td class="bs-number">$20,000</td>
                <td class="bs-number">$21,000</td>
                <td class="bs-number">$21,000</td>
                <td class="bs-number">$21,000</td>
                <td class="bs-number">$22,000</td>
                <td class="bs-number">$22,000</td>
                <td class="bs-number">$23,000</td>
              </tr>
              
              <!-- Level 2 -->
              <tr class="bs-level2">
                <td><span class="bs-fixed-icon">📌</span>Operating Expenses</td>
                <td class="bs-number">$40,000</td>
                <td class="bs-number">$42,000</td>
                <td class="bs-number">$41,000</td>
                <td class="bs-number">$43,000</td>
                <td class="bs-number">$44,000</td>
                <td class="bs-number">$45,000</td>
                <td class="bs-number">$46,000</td>
              </tr>
              
              <tr class="bs-level3 draggable" draggable="true">
                <td><span class="bs-drag-icon">≡</span>Salaries</td>
                <td class="bs-number">$25,000</td>
                <td class="bs-number">$26,000</td>
                <td class="bs-number">$25,000</td>
                <td class="bs-number">$26,000</td>
                <td class="bs-number">$27,000</td>
                <td class="bs-number">$27,000</td>
                <td class="bs-number">$28,000</td>
              </tr>
              
              <tr class="bs-level3 draggable" draggable="true">
                <td><span class="bs-drag-icon">≡</span>Rent</td>
                <td class="bs-number">$10,000</td>
                <td class="bs-number">$10,000</td>
                <td class="bs-number">$10,000</td>
                <td class="bs-number">$10,000</td>
                <td class="bs-number">$10,000</td>
                <td class="bs-number">$11,000</td>
                <td class="bs-number">$11,000</td>
              </tr>
              
              <tr class="bs-level3 draggable" draggable="true">
                <td><span class="bs-drag-icon">≡</span>Utilities</td>
                <td class="bs-number">$5,000</td>
                <td class="bs-number">$6,000</td>
                <td class="bs-number">$6,000</td>
                <td class="bs-number">$7,000</td>
                <td class="bs-number">$7,000</td>
                <td class="bs-number">$7,000</td>
                <td class="bs-number">$7,000</td>
              </tr>
              
              <!-- Level 1 -->
              <tr class="bs-level1">
                <td><span class="bs-fixed-icon">📌</span>Net Income</td>
                <td class="bs-number bs-positive">$50,000</td>
                <td class="bs-number bs-positive">$55,000</td>
                <td class="bs-number bs-positive">$52,000</td>
                <td class="bs-number bs-positive">$58,000</td>
                <td class="bs-number bs-positive">$60,000</td>
                <td class="bs-number bs-positive">$63,000</td>
                <td class="bs-number bs-positive">$65,000</td>
              </tr>
            </tbody>
          </table>
        </div>
      `;
      container.appendChild(contentDiv);
      
      // Add drag and drop functionality
      setupDragAndDrop('plTable');
    }

    /******************** DRAG AND DROP FUNCTIONALITY *************************/
    function setupDragAndDrop(tableId) {
      const table = document.getElementById(tableId);
      if (!table) return;
      
      let draggedItem = null;
      
      // Get all draggable rows
      const draggableRows = table.querySelectorAll('.draggable');
      
      // Add drag events to draggable rows
      draggableRows.forEach(row => {
        row.addEventListener('dragstart', function() {
          draggedItem = this;
          setTimeout(() => this.classList.add('dragging'), 0);
        });
        
        row.addEventListener('dragend', function() {
          this.classList.remove('dragging');
          draggedItem = null;
          
          // Remove all dragover classes
          table.querySelectorAll('.dragging-over').forEach(item => {
            item.classList.remove('dragging-over');
          });
        });
      });
      
      // Add drag events to potential drop targets
      draggableRows.forEach(row => {
        row.addEventListener('dragover', function(e) {
          e.preventDefault();
          if (draggedItem === this) return;
          this.classList.add('dragging-over');
        });
        
        row.addEventListener('dragleave', function() {
          this.classList.remove('dragging-over');
        });
        
        row.addEventListener('drop', function(e) {
          e.preventDefault();
          if (draggedItem === this) return;
          
          // Get the parent sections of both rows
          const draggedParent = getParentSection(draggedItem);
          const dropParent = getParentSection(this);
          
          // Only allow dropping if both are in the same section
          if (draggedParent && dropParent && draggedParent === dropParent) {
            // Insert the dragged row before or after the drop target based on position
            const rect = this.getBoundingClientRect();
            const midpoint = rect.top + rect.height / 2;
            
            if (e.clientY < midpoint) {
              this.parentNode.insertBefore(draggedItem, this);
            } else {
              this.parentNode.insertBefore(draggedItem, this.nextSibling);
            }
          }
          
          this.classList.remove('dragging-over');
        });
      });
      
      // Helper function to find parent section (level2)
      function getParentSection(row) {
        let current = row.previousElementSibling;
        while (current) {
          if (current.classList.contains('bs-level2')) {
            return current;
          }
          current = current.previousElementSibling;
        }
        return null;
      }
    }

    /******************** INITIALIZE APPLICATION *************************/
    // Initialize the app when DOM is loaded
    document.addEventListener('DOMContentLoaded', () => {
      const main = document.getElementById('mainContent');
      renderUnderwritingList(main);
      
      // Add back button click handlers
      document.getElementById('backBtn').addEventListener('click', goBackToList);
      document.getElementById('backToListBtn').addEventListener('click', goBackToList);
      
      // Add company screen navigation click handlers
      document.querySelectorAll('[data-company-screen]').forEach(item => {
        item.addEventListener('click', () => {
          loadCompanyScreen(item.dataset.companyScreen);
        });
      });
    });

    /******************** BANKING LABELING RENDERER *************************/
    function renderBankLabeling(container) {
      // Create the Banking Labeling content
      const contentDiv = document.createElement('div');
      contentDiv.innerHTML = `
        <h1>Banking Labeling</h1>
        
        <div style="margin-bottom: 1rem; display: flex; justify-content: space-between;">
          <div>
            <button class="bs-button">Reset</button>
            <button class="bs-button">Undo</button>
          </div>
          <div>
            <button class="bs-button primary">Save Changes</button>
          </div>
        </div>
        
        <div style="margin-bottom: 1rem;">
          <div style="display: flex; gap: 1rem; align-items: center; margin-bottom: 0.5rem;">
            <div>
              <div style="font-weight: 500; margin-bottom: 0.5rem;">Date Range:</div>
              <div style="display: flex; gap: 0.5rem;">
                <input type="text" value="01/01/2023" style="width: 120px; padding: 0.5rem; border: 1px solid var(--border); background: var(--panel); color: var(--text); border-radius: 4px;">
                <input type="text" value="07/31/2023" style="width: 120px; padding: 0.5rem; border: 1px solid var(--border); background: var(--panel); color: var(--text); border-radius: 4px;">
              </div>
            </div>
            <div>
              <div style="font-weight: 500; margin-bottom: 0.5rem;">Account:</div>
              <div style="position: relative; width: 200px;">
                <select style="width: 100%; padding: 0.5rem; border: 1px solid var(--border); background: var(--panel); color: var(--text); border-radius: 4px;">
                  <option selected>All Accounts</option>
                  <option>Checking Account</option>
                  <option>Savings Account</option>
                  <option>Business Credit Card</option>
                </select>
                <div style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); color: var(--accent);">▼</div>
              </div>
            </div>
            <div>
              <div style="font-weight: 500; margin-bottom: 0.5rem;">Amount:</div>
              <div style="display: flex; gap: 0.5rem;">
                <input type="text" placeholder="Min" style="width: 80px; padding: 0.5rem; border: 1px solid var(--border); background: var(--panel); color: var(--text); border-radius: 4px;">
                <input type="text" placeholder="Max" style="width: 80px; padding: 0.5rem; border: 1px solid var(--border); background: var(--panel); color: var(--text); border-radius: 4px;">
              </div>
            </div>
            <div>
              <div style="font-weight: 500; margin-bottom: 0.5rem;">Current Label:</div>
              <div style="position: relative; width: 200px;">
                <select style="width: 100%; padding: 0.5rem; border: 1px solid var(--border); background: var(--panel); color: var(--text); border-radius: 4px;">
                  <option selected>All Labels</option>
                  <option>Revenue</option>
                  <option>Expense</option>
                  <option>Debt Repayment</option>
                  <option>Debt Investment</option>
                  <option>Equity Investment</option>
                  <option>Other Inflow</option>
                  <option>Other Outflow</option>
                  <option>Intercompany Transfer</option>
                </select>
                <div style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); color: var(--accent);">▼</div>
              </div>
            </div>
          </div>
          <button class="bs-button" style="margin-top: 0.5rem;">Apply Filters</button>
        </div>
        
        <div class="bs-container">
          <table class="bs-table" id="bankingTable" style="table-layout: fixed;">
            <thead>
              <tr class="bs-header-row">
                <th style="width: 12%;">Date</th>
                <th style="width: 12%;">Amount</th>
                <th style="width: 51%;">Description</th>
                <th style="width: 25%;">Label</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>07/28/2023</td>
                <td class="bs-number bs-positive">$5,432.78</td>
                <td>Payment from ACME Corp for Invoice #12345</td>
                <td>
                  <div style="position: relative;">
                    <select class="label-select" style="width: 100%; padding: 0.4rem; border: 1px solid var(--border); background: var(--panel); color: var(--text); border-radius: 4px;">
                      <option selected>Revenue</option>
                      <option>Expense</option>
                      <option>Debt Repayment</option>
                      <option>Debt Investment</option>
                      <option>Equity Investment</option>
                      <option>Other Inflow</option>
                      <option>Other Outflow</option>
                      <option>Intercompany Transfer</option>
                    </select>
                    <div style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); color: var(--accent);">▼</div>
                  </div>
                </td>
              </tr>
              <tr>
                <td>07/27/2023</td>
                <td class="bs-number bs-negative">-$1,250.00</td>
                <td>Office Rent Payment - July 2023</td>
                <td>
                  <div style="position: relative;">
                    <select class="label-select" style="width: 100%; padding: 0.4rem; border: 1px solid var(--border); background: var(--panel); color: var(--text); border-radius: 4px;">
                      <option>Revenue</option>
                      <option selected>Expense</option>
                      <option>Debt Repayment</option>
                      <option>Debt Investment</option>
                      <option>Equity Investment</option>
                      <option>Other Inflow</option>
                      <option>Other Outflow</option>
                      <option>Intercompany Transfer</option>
                    </select>
                    <div style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); color: var(--accent);">▼</div>
                  </div>
                </td>
              </tr>
              <tr>
                <td>07/25/2023</td>
                <td class="bs-number bs-negative">-$2,500.00</td>
                <td>Loan Payment - Principal and Interest</td>
                <td>
                  <div style="position: relative;">
                    <select class="label-select" style="width: 100%; padding: 0.4rem; border: 1px solid var(--border); background: var(--panel); color: var(--text); border-radius: 4px;">
                      <option>Revenue</option>
                      <option>Expense</option>
                      <option selected>Debt Repayment</option>
                      <option>Debt Investment</option>
                      <option>Equity Investment</option>
                      <option>Other Inflow</option>
                      <option>Other Outflow</option>
                      <option>Intercompany Transfer</option>
                    </select>
                    <div style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); color: var(--accent);">▼</div>
                  </div>
                </td>
              </tr>
              <tr>
                <td>07/22/2023</td>
                <td class="bs-number bs-positive">$3,879.15</td>
                <td>Payment from XYZ Industries for Services</td>
                <td>
                  <div style="position: relative;">
                    <select class="label-select" style="width: 100%; padding: 0.4rem; border: 1px solid var(--border); background: var(--panel); color: var(--text); border-radius: 4px;">
                      <option selected>Revenue</option>
                      <option>Expense</option>
                      <option>Debt Repayment</option>
                      <option>Debt Investment</option>
                      <option>Equity Investment</option>
                      <option>Other Inflow</option>
                      <option>Other Outflow</option>
                      <option>Intercompany Transfer</option>
                    </select>
                    <div style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); color: var(--accent);">▼</div>
                  </div>
                </td>
              </tr>
              <tr>
                <td>07/20/2023</td>
                <td class="bs-number bs-negative">-$1,150.75</td>
                <td>Cloud Services Monthly Subscription</td>
                <td>
                  <div style="position: relative;">
                    <select class="label-select" style="width: 100%; padding: 0.4rem; border: 1px solid var(--border); background: var(--panel); color: var(--text); border-radius: 4px;">
                      <option>Revenue</option>
                      <option selected>Expense</option>
                      <option>Debt Repayment</option>
                      <option>Debt Investment</option>
                      <option>Equity Investment</option>
                      <option>Other Inflow</option>
                      <option>Other Outflow</option>
                      <option>Intercompany Transfer</option>
                    </select>
                    <div style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); color: var(--accent);">▼</div>
                  </div>
                </td>
              </tr>
              <tr>
                <td>07/18/2023</td>
                <td class="bs-number bs-negative">-$875.32</td>
                <td>Office Supplies and Equipment</td>
                <td>
                  <div style="position: relative;">
                    <select class="label-select" style="width: 100%; padding: 0.4rem; border: 1px solid var(--border); background: var(--panel); color: var(--text); border-radius: 4px;">
                      <option>Revenue</option>
                      <option selected>Expense</option>
                      <option>Debt Repayment</option>
                      <option>Debt Investment</option>
                      <option>Equity Investment</option>
                      <option>Other Inflow</option>
                      <option>Other Outflow</option>
                      <option>Intercompany Transfer</option>
                    </select>
                    <div style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); color: var(--accent);">▼</div>
                  </div>
                </td>
              </tr>
              <tr>
                <td>07/15/2023</td>
                <td class="bs-number bs-positive">$50,000.00</td>
                <td>Business Loan Deposit</td>
                <td>
                  <div style="position: relative;">
                    <select class="label-select" style="width: 100%; padding: 0.4rem; border: 1px solid var(--border); background: var(--panel); color: var(--text); border-radius: 4px;">
                      <option>Revenue</option>
                      <option>Expense</option>
                      <option>Debt Repayment</option>
                      <option selected>Debt Investment</option>
                      <option>Equity Investment</option>
                      <option>Other Inflow</option>
                      <option>Other Outflow</option>
                      <option>Intercompany Transfer</option>
                    </select>
                    <div style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); color: var(--accent);">▼</div>
                  </div>
                </td>
              </tr>
              <tr>
                <td>07/12/2023</td>
                <td class="bs-number bs-negative">-$3,215.67</td>
                <td>Employee Payroll</td>
                <td>
                  <div style="position: relative;">
                    <select class="label-select" style="width: 100%; padding: 0.4rem; border: 1px solid var(--border); background: var(--panel); color: var(--text); border-radius: 4px;">
                      <option>Revenue</option>
                      <option selected>Expense</option>
                      <option>Debt Repayment</option>
                      <option>Debt Investment</option>
                      <option>Equity Investment</option>
                      <option>Other Inflow</option>
                      <option>Other Outflow</option>
                      <option>Intercompany Transfer</option>
                    </select>
                    <div style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); color: var(--accent);">▼</div>
                  </div>
                </td>
              </tr>
              <tr>
                <td>07/10/2023</td>
                <td class="bs-number bs-positive">$25,000.00</td>
                <td>Transfer from Subsidiary Account</td>
                <td>
                  <div style="position: relative;">
                    <select class="label-select" style="width: 100%; padding: 0.4rem; border: 1px solid var(--border); background: var(--panel); color: var(--text); border-radius: 4px;">
                      <option>Revenue</option>
                      <option>Expense</option>
                      <option>Debt Repayment</option>
                      <option>Debt Investment</option>
                      <option>Equity Investment</option>
                      <option>Other Inflow</option>
                      <option>Other Outflow</option>
                      <option selected>Intercompany Transfer</option>
                    </select>
                    <div style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); color: var(--accent);">▼</div>
                  </div>
                </td>
              </tr>
              <tr>
                <td>07/05/2023</td>
                <td class="bs-number bs-positive">$100,000.00</td>
                <td>Series A Investment - First Tranche</td>
                <td>
                  <div style="position: relative;">
                    <select class="label-select" style="width: 100%; padding: 0.4rem; border: 1px solid var(--border); background: var(--panel); color: var(--text); border-radius: 4px;">
                      <option>Revenue</option>
                      <option>Expense</option>
                      <option>Debt Repayment</option>
                      <option>Debt Investment</option>
                      <option selected>Equity Investment</option>
                      <option>Other Inflow</option>
                      <option>Other Outflow</option>
                      <option>Intercompany Transfer</option>
                    </select>
                    <div style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); color: var(--accent);">▼</div>
                  </div>
                </td>
              </tr>
              <tr>
                <td>07/03/2023</td>
                <td class="bs-number bs-negative">-$2,150.00</td>
                <td>Marketing Services - Social Media Campaign</td>
                <td>
                  <div style="position: relative;">
                    <select class="label-select" style="width: 100%; padding: 0.4rem; border: 1px solid var(--border); background: var(--panel); color: var(--text); border-radius: 4px;">
                      <option>Revenue</option>
                      <option selected>Expense</option>
                      <option>Debt Repayment</option>
                      <option>Debt Investment</option>
                      <option>Equity Investment</option>
                      <option>Other Inflow</option>
                      <option>Other Outflow</option>
                      <option>Intercompany Transfer</option>
                    </select>
                    <div style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); color: var(--accent);">▼</div>
                  </div>
                </td>
              </tr>
              <tr>
                <td>07/01/2023</td>
                <td class="bs-number bs-positive">$7,890.45</td>
                <td>Customer Payment - Invoice #10982</td>
                <td>
                  <div style="position: relative;">
                    <select class="label-select" style="width: 100%; padding: 0.4rem; border: 1px solid var(--border); background: var(--panel); color: var(--text); border-radius: 4px;">
                      <option selected>Revenue</option>
                      <option>Expense</option>
                      <option>Debt Repayment</option>
                      <option>Debt Investment</option>
                      <option>Equity Investment</option>
                      <option>Other Inflow</option>
                      <option>Other Outflow</option>
                      <option>Intercompany Transfer</option>
                    </select>
                    <div style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); color: var(--accent);">▼</div>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        
        <div style="margin-top: 1rem; display: flex; justify-content: space-between; align-items: center;">
          <div>
            <span style="color: var(--muted);">Showing 12 of 238 transactions</span>
          </div>
          <div style="display: flex; gap: 0.5rem;">
            <button class="bs-button">Previous</button>
            <button class="bs-button">Next</button>
          </div>
        </div>
      `;
      container.appendChild(contentDiv);
      
      // Add event listeners for label selection
      document.querySelectorAll('.label-select').forEach(select => {
        select.addEventListener('change', function() {
          console.log(`Transaction relabeled to: ${this.value}`);
          // Here we would typically save the change to a database
        });
      });
    }

    /******************** SCORING RENDERER *************************/
    function renderScoring(container) {
      // Create the Scoring content
      const contentDiv = document.createElement('div');
      contentDiv.innerHTML = `
        <h1>Scoring</h1>
        
        <div style="margin-bottom: 2rem;">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
            <h2 style="font-size: 1.2rem; font-weight: 500;">Parker Group, Inc. - Credit Scorecard</h2>
            <div>
              <button class="bs-button primary">Generate Report</button>
            </div>
          </div>
          
          <div style="display: flex; gap: 1rem; margin-bottom: 1.5rem;">
            <div style="background: var(--panel); border-radius: 8px; padding: 1.5rem; flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center;">
              <div style="font-size: 0.9rem; color: var(--muted); margin-bottom: 0.5rem;">Overall Grade</div>
              <div style="font-size: 3rem; font-weight: 600; color: #3498db;">B</div>
              <div style="font-size: 0.9rem; margin-top: 0.5rem;">Score: 72/100</div>
            </div>
            
            <div style="display: flex; flex-direction: column; gap: 0.5rem; flex: 3;">
              <div style="display: flex; align-items: center; gap: 1rem;">
                <div style="width: 100px; text-align: right; font-size: 0.9rem; color: var(--muted);">Revenue</div>
                <div style="flex-grow: 1; height: 10px; background: var(--border); border-radius: 5px;">
                  <div style="width: 80%; height: 100%; background: #3498db; border-radius: 5px;"></div>
                </div>
                <div style="width: 30px; text-align: right; font-weight: 600;">B</div>
              </div>
              
              <div style="display: flex; align-items: center; gap: 1rem;">
                <div style="width: 100px; text-align: right; font-size: 0.9rem; color: var(--muted);">Profitability</div>
                <div style="flex-grow: 1; height: 10px; background: var(--border); border-radius: 5px;">
                  <div style="width: 60%; height: 100%; background: #e74c3c; border-radius: 5px;"></div>
                </div>
                <div style="width: 30px; text-align: right; font-weight: 600;">C</div>
              </div>
              
              <div style="display: flex; align-items: center; gap: 1rem;">
                <div style="width: 100px; text-align: right; font-size: 0.9rem; color: var(--muted);">Liquidity</div>
                <div style="flex-grow: 1; height: 10px; background: var(--border); border-radius: 5px;">
                  <div style="width: 80%; height: 100%; background: #3498db; border-radius: 5px;"></div>
                </div>
                <div style="width: 30px; text-align: right; font-weight: 600;">B</div>
              </div>
              
              <div style="display: flex; align-items: center; gap: 1rem;">
                <div style="width: 100px; text-align: right; font-size: 0.9rem; color: var(--muted);">Cash</div>
                <div style="flex-grow: 1; height: 10px; background: var(--border); border-radius: 5px;">
                  <div style="width: 80%; height: 100%; background: #3498db; border-radius: 5px;"></div>
                </div>
                <div style="width: 30px; text-align: right; font-weight: 600;">B</div>
              </div>
              
              <div style="display: flex; align-items: center; gap: 1rem;">
                <div style="width: 100px; text-align: right; font-size: 0.9rem; color: var(--muted);">Debt/Liabilities</div>
                <div style="flex-grow: 1; height: 10px; background: var(--border); border-radius: 5px;">
                  <div style="width: 60%; height: 100%; background: #e74c3c; border-radius: 5px;"></div>
                </div>
                <div style="width: 30px; text-align: right; font-weight: 600;">C</div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Revenue Section -->
        <div style="margin-bottom: 2rem;">
          <div style="background: #3498db; color: white; font-weight: 600; padding: 0.5rem 1rem; border-radius: 4px 4px 0 0;">
            Revenue
          </div>
          <div style="border: 1px solid var(--border); border-top: none; border-radius: 0 0 4px 4px; overflow: hidden;">
            <div style="padding: 0.5rem 1rem; background: var(--panel); display: flex; justify-content: space-between; border-bottom: 1px solid var(--border);">
              <div style="font-weight: 600;">Grade:</div>
              <div style="font-weight: 600; color: #3498db;">B</div>
            </div>
            <table style="width: 100%; border-collapse: collapse; font-size: 0.9rem;">
              <thead>
                <tr style="background: var(--panel); border-bottom: 1px solid var(--border);">
                  <th style="padding: 0.7rem 1rem; text-align: left; width: 25%;">Metric</th>
                  <th style="padding: 0.7rem 1rem; text-align: left; width: 15%;">Value</th>
                  <th style="padding: 0.7rem 1rem; text-align: left; width: 25%;">Source</th>
                  <th style="padding: 0.7rem 1rem; text-align: left; width: 15%;">Scorecard grade</th>
                  <th style="padding: 0.7rem 1rem; text-align: left; width: 20%;">Scorecard weight</th>
                </tr>
              </thead>
              <tbody>
                <tr style="border-bottom: 1px solid var(--border);">
                  <td style="padding: 0.7rem 1rem;">Avg YoY Growth</td>
                  <td style="padding: 0.7rem 1rem;">50%</td>
                  <td style="padding: 0.7rem 1rem;">Accounting P&L_L3M</td>
                  <td style="padding: 0.7rem 1rem;">C</td>
                  <td style="padding: 0.7rem 1rem;">10%</td>
                </tr>
                <tr style="border-bottom: 1px solid var(--border);">
                  <td style="padding: 0.7rem 1rem;">Revenue LTM</td>
                  <td style="padding: 0.7rem 1rem;">$11,417,164</td>
                  <td style="padding: 0.7rem 1rem;">Accounting P&L_L12M</td>
                  <td style="padding: 0.7rem 1rem;">A</td>
                  <td style="padding: 0.7rem 1rem;">5%</td>
                </tr>
                <tr>
                  <td style="padding: 0.7rem 1rem;">Seasonality</td>
                  <td style="padding: 0.7rem 1rem;">34.4%</td>
                  <td style="padding: 0.7rem 1rem;">Accounting P&L_L12M</td>
                  <td style="padding: 0.7rem 1rem;">C</td>
                  <td style="padding: 0.7rem 1rem;">10%</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        
        <!-- Profitability Section -->
        <div style="margin-bottom: 2rem;">
          <div style="background: #e74c3c; color: white; font-weight: 600; padding: 0.5rem 1rem; border-radius: 4px 4px 0 0;">
            Profitability
          </div>
          <div style="border: 1px solid var(--border); border-top: none; border-radius: 0 0 4px 4px; overflow: hidden;">
            <div style="padding: 0.5rem 1rem; background: var(--panel); display: flex; justify-content: space-between; border-bottom: 1px solid var(--border);">
              <div style="font-weight: 600;">Grade:</div>
              <div style="font-weight: 600; color: #e74c3c;">C</div>
            </div>
            <table style="width: 100%; border-collapse: collapse; font-size: 0.9rem;">
              <thead>
                <tr style="background: var(--panel); border-bottom: 1px solid var(--border);">
                  <th style="padding: 0.7rem 1rem; text-align: left; width: 25%;">Metric</th>
                  <th style="padding: 0.7rem 1rem; text-align: left; width: 15%;">Value</th>
                  <th style="padding: 0.7rem 1rem; text-align: left; width: 25%;">Source</th>
                  <th style="padding: 0.7rem 1rem; text-align: left; width: 15%;">Scorecard grade</th>
                  <th style="padding: 0.7rem 1rem; text-align: left; width: 20%;">Scorecard weight</th>
                </tr>
              </thead>
              <tbody>
                <tr style="border-bottom: 1px solid var(--border);">
                  <td style="padding: 0.7rem 1rem;">Net Operating Profit</td>
                  <td style="padding: 0.7rem 1rem;">-5.6%</td>
                  <td style="padding: 0.7rem 1rem;">Accounting P&L_L3M</td>
                  <td style="padding: 0.7rem 1rem;">C</td>
                  <td style="padding: 0.7rem 1rem;">10%</td>
                </tr>
                <tr>
                  <td style="padding: 0.7rem 1rem;">Net Profit</td>
                  <td style="padding: 0.7rem 1rem;">-9.3%</td>
                  <td style="padding: 0.7rem 1rem;">Accounting P&L_L3M</td>
                  <td style="padding: 0.7rem 1rem;">C</td>
                  <td style="padding: 0.7rem 1rem;">10%</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        
        <!-- Liquidity/Working Capital Section -->
        <div style="margin-bottom: 2rem;">
          <div style="background: #3498db; color: white; font-weight: 600; padding: 0.5rem 1rem; border-radius: 4px 4px 0 0;">
            Liquidity/Working Capital
          </div>
          <div style="border: 1px solid var(--border); border-top: none; border-radius: 0 0 4px 4px; overflow: hidden;">
            <div style="padding: 0.5rem 1rem; background: var(--panel); display: flex; justify-content: space-between; border-bottom: 1px solid var(--border);">
              <div style="font-weight: 600;">Grade:</div>
              <div style="font-weight: 600; color: #3498db;">B</div>
            </div>
            <table style="width: 100%; border-collapse: collapse; font-size: 0.9rem;">
              <thead>
                <tr style="background: var(--panel); border-bottom: 1px solid var(--border);">
                  <th style="padding: 0.7rem 1rem; text-align: left; width: 25%;">Metric</th>
                  <th style="padding: 0.7rem 1rem; text-align: left; width: 15%;">Value</th>
                  <th style="padding: 0.7rem 1rem; text-align: left; width: 25%;">Source</th>
                  <th style="padding: 0.7rem 1rem; text-align: left; width: 15%;">Scorecard grade</th>
                  <th style="padding: 0.7rem 1rem; text-align: left; width: 20%;">Scorecard weight</th>
                </tr>
              </thead>
              <tbody>
                <tr style="border-bottom: 1px solid var(--border);">
                  <td style="padding: 0.7rem 1rem;">Current Ratio</td>
                  <td style="padding: 0.7rem 1rem;">1.7</td>
                  <td style="padding: 0.7rem 1rem;">Accounting BS_LM</td>
                  <td style="padding: 0.7rem 1rem;">C</td>
                  <td style="padding: 0.7rem 1rem;">7%</td>
                </tr>
                <tr style="border-bottom: 1px solid var(--border);">
                  <td style="padding: 0.7rem 1rem;">Quick Ratio</td>
                  <td style="padding: 0.7rem 1rem;">0.8</td>
                  <td style="padding: 0.7rem 1rem;">Accounting BS_LM</td>
                  <td style="padding: 0.7rem 1rem;">B</td>
                  <td style="padding: 0.7rem 1rem;">5%</td>
                </tr>
                <tr style="border-bottom: 1px solid var(--border);">
                  <td style="padding: 0.7rem 1rem;">Quick Ratio YoY</td>
                  <td style="padding: 0.7rem 1rem;">-38.3%</td>
                  <td style="padding: 0.7rem 1rem;">QR / QR LY -1</td>
                  <td style="padding: 0.7rem 1rem;">D</td>
                  <td style="padding: 0.7rem 1rem;">3%</td>
                </tr>
                <tr>
                  <td style="padding: 0.7rem 1rem;">Current Ratio QoQ</td>
                  <td style="padding: 0.7rem 1rem;">-3.6%</td>
                  <td style="padding: 0.7rem 1rem;">CR / CR LQ -1</td>
                  <td style="padding: 0.7rem 1rem;">C</td>
                  <td style="padding: 0.7rem 1rem;">2%</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        
        <!-- Cash Section -->
        <div style="margin-bottom: 2rem;">
          <div style="background: #3498db; color: white; font-weight: 600; padding: 0.5rem 1rem; border-radius: 4px 4px 0 0;">
            Cash
          </div>
          <div style="border: 1px solid var(--border); border-top: none; border-radius: 0 0 4px 4px; overflow: hidden;">
            <div style="padding: 0.5rem 1rem; background: var(--panel); display: flex; justify-content: space-between; border-bottom: 1px solid var(--border);">
              <div style="font-weight: 600;">Grade:</div>
              <div style="font-weight: 600; color: #3498db;">B</div>
            </div>
            <table style="width: 100%; border-collapse: collapse; font-size: 0.9rem;">
              <thead>
                <tr style="background: var(--panel); border-bottom: 1px solid var(--border);">
                  <th style="padding: 0.7rem 1rem; text-align: left; width: 25%;">Metric</th>
                  <th style="padding: 0.7rem 1rem; text-align: left; width: 15%;">Value</th>
                  <th style="padding: 0.7rem 1rem; text-align: left; width: 25%;">Source</th>
                  <th style="padding: 0.7rem 1rem; text-align: left; width: 15%;">Scorecard grade</th>
                  <th style="padding: 0.7rem 1rem; text-align: left; width: 20%;">Scorecard weight</th>
                </tr>
              </thead>
              <tbody>
                <tr style="border-bottom: 1px solid var(--border);">
                  <td style="padding: 0.7rem 1rem;">Cash Latest</td>
                  <td style="padding: 0.7rem 1rem;">$482,352</td>
                  <td style="padding: 0.7rem 1rem;">Banking_LM</td>
                  <td style="padding: 0.7rem 1rem;">B</td>
                  <td style="padding: 0.7rem 1rem;">3%</td>
                </tr>
                <tr style="border-bottom: 1px solid var(--border);">
                  <td style="padding: 0.7rem 1rem;">Credit Limit to Avg. Available Cash</td>
                  <td style="padding: 0.7rem 1rem;">0.36</td>
                  <td style="padding: 0.7rem 1rem;">CL / Avg. Available Cash</td>
                  <td style="padding: 0.7rem 1rem;">A</td>
                  <td style="padding: 0.7rem 1rem;">4%</td>
                </tr>
                <tr style="border-bottom: 1px solid var(--border);">
                  <td style="padding: 0.7rem 1rem;">Avg. Available Cash L3M QoQ</td>
                  <td style="padding: 0.7rem 1rem;">-0.42</td>
                  <td style="padding: 0.7rem 1rem;">Avg. Available Cash / Avg</td>
                  <td style="padding: 0.7rem 1rem;">D</td>
                  <td style="padding: 0.7rem 1rem;">2%</td>
                </tr>
                <tr>
                  <td style="padding: 0.7rem 1rem;">Cash Avg</td>
                  <td style="padding: 0.7rem 1rem;">954,860.53</td>
                  <td style="padding: 0.7rem 1rem;">Banking_LM</td>
                  <td style="padding: 0.7rem 1rem;">B</td>
                  <td style="padding: 0.7rem 1rem;">4%</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        
        <!-- Debt/Liabilities Section -->
        <div style="margin-bottom: 2rem;">
          <div style="background: #e74c3c; color: white; font-weight: 600; padding: 0.5rem 1rem; border-radius: 4px 4px 0 0;">
            Debt/Liabilities
          </div>
          <div style="border: 1px solid var(--border); border-top: none; border-radius: 0 0 4px 4px; overflow: hidden;">
            <div style="padding: 0.5rem 1rem; background: var(--panel); display: flex; justify-content: space-between; border-bottom: 1px solid var(--border);">
              <div style="font-weight: 600;">Grade:</div>
              <div style="font-weight: 600; color: #e74c3c;">C</div>
            </div>
            <table style="width: 100%; border-collapse: collapse; font-size: 0.9rem;">
              <thead>
                <tr style="background: var(--panel); border-bottom: 1px solid var(--border);">
                  <th style="padding: 0.7rem 1rem; text-align: left; width: 25%;">Metric</th>
                  <th style="padding: 0.7rem 1rem; text-align: left; width: 15%;">Value</th>
                  <th style="padding: 0.7rem 1rem; text-align: left; width: 25%;">Source</th>
                  <th style="padding: 0.7rem 1rem; text-align: left; width: 15%;">Scorecard grade</th>
                  <th style="padding: 0.7rem 1rem; text-align: left; width: 20%;">Scorecard weight</th>
                </tr>
              </thead>
              <tbody>
                <tr style="border-bottom: 1px solid var(--border);">
                  <td style="padding: 0.7rem 1rem;">Liabilities LM to Avg. Revenue L3M</td>
                  <td style="padding: 0.7rem 1rem;">3.92</td>
                  <td style="padding: 0.7rem 1rem;">Liabilities / Revenue</td>
                  <td style="padding: 0.7rem 1rem;">E</td>
                  <td style="padding: 0.7rem 1rem;">13%</td>
                </tr>
                <tr style="border-bottom: 1px solid var(--border);">
                  <td style="padding: 0.7rem 1rem;">Liabilities LM to Avg. Available Cash L3M</td>
                  <td style="padding: 0.7rem 1rem;">3.67</td>
                  <td style="padding: 0.7rem 1rem;">Liabilities / Avg. Available</td>
                  <td style="padding: 0.7rem 1rem;">B</td>
                  <td style="padding: 0.7rem 1rem;">5%</td>
                </tr>
                <tr>
                  <td style="padding: 0.7rem 1rem;">Debt Service LM to Avg. Revenue L12M</td>
                  <td style="padding: 0.7rem 1rem;">0.01</td>
                  <td style="padding: 0.7rem 1rem;">Debt Repayment / Gross</td>
                  <td style="padding: 0.7rem 1rem;">A</td>
                  <td style="padding: 0.7rem 1rem;">5%</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        
        <!-- Recommendation Section -->
        <div style="margin-bottom: 2rem;">
          <div style="background: var(--panel); border-radius: 8px; padding: 1.5rem;">
            <h2 style="font-size: 1.2rem; font-weight: 500; margin-bottom: 1rem;">Recommendations</h2>
            <div style="display: flex; gap: 2rem;">
              <div style="flex: 1;">
                <h3 style="font-size: 1rem; margin-bottom: 0.75rem;">Credit Limit Recommendation</h3>
                <div style="font-size: 1.75rem; font-weight: 600; color: #3498db; margin-bottom: 0.5rem;">$350,000</div>
                <div style="font-size: 0.9rem; color: var(--muted);">Based on cash flow and revenue</div>
              </div>
              <div style="flex: 1;">
                <h3 style="font-size: 1rem; margin-bottom: 0.75rem;">APR Recommendation</h3>
                <div style="font-size: 1.75rem; font-weight: 600; color: #3498db; margin-bottom: 0.5rem;">16.5%</div>
                <div style="font-size: 0.9rem; color: var(--muted);">Based on risk profile</div>
              </div>
              <div style="flex: 1;">
                <h3 style="font-size: 1rem; margin-bottom: 0.75rem;">Payment Terms</h3>
                <div style="font-size: 1.75rem; font-weight: 600; color: #3498db; margin-bottom: 0.5rem;">Net 30</div>
                <div style="font-size: 0.9rem; color: var(--muted);">Standard terms</div>
              </div>
            </div>
          </div>
        </div>
      `;
      container.appendChild(contentDiv);
    }

    /******************** GRAPHS & METRICS RENDERER *************************/
    function renderGraphsMetrics(container) {
      // Create the Graphs & Metrics content
      const contentDiv = document.createElement('div');
      contentDiv.innerHTML = `
        <h1>Graphs & Metric Decisions</h1>
        
        <!-- Category Header - Revenue -->
        <div style="background: #3498db; color: white; font-weight: 600; padding: 0.5rem 1rem; border-radius: 4px 4px 0 0; margin-top: 1.5rem;">
          Revenue
        </div>
        
        <!-- Graphs Section -->
        <div style="border: 1px solid var(--border); border-top: none; border-radius: 0 0 4px 4px; overflow: hidden; padding: 1.5rem; margin-bottom: 2rem;">
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem;">
            <!-- Revenue Chart -->
            <div style="border: 1px solid var(--border); border-radius: 8px; padding: 1rem; position: relative; height: 300px;">
              <h3 style="font-size: 1rem; text-align: center; margin-bottom: 0.5rem;">Revenue</h3>
              <div style="position: absolute; top: 2.5rem; left: 1rem; font-size: 0.7rem;">
                <div style="display: flex; align-items: center; gap: 0.3rem;">
                  <div style="width: 12px; height: 3px; background: #2ecc71;"></div>
                  <span>Sales - Total Sales</span>
                </div>
                <div style="display: flex; align-items: center; gap: 0.3rem;">
                  <div style="width: 12px; height: 3px; background: #e74c3c;"></div>
                  <span>Bank - Revenue</span>
                </div>
                <div style="display: flex; align-items: center; gap: 0.3rem;">
                  <div style="width: 12px; height: 3px; background: #3498db;"></div>
                  <span>Acc - Net sales</span>
                </div>
                <div style="display: flex; align-items: center; gap: 0.3rem;">
                  <div style="width: 12px; height: 3px; background: #f39c12;"></div>
                  <span>Shopify</span>
                </div>
              </div>
              <canvas id="revenueChart" height="250"></canvas>
            </div>
            
            <!-- Seasonality Chart -->
            <div style="border: 1px solid var(--border); border-radius: 8px; padding: 1rem; position: relative; height: 300px;">
              <h3 style="font-size: 1rem; text-align: center; margin-bottom: 0.5rem;">Seasonality</h3>
              <div style="position: absolute; top: 2.5rem; left: 1rem; font-size: 0.7rem;">
                <div style="display: flex; align-items: center; gap: 0.3rem;">
                  <div style="width: 12px; height: 12px; background: #3498db;"></div>
                  <span>Accounting</span>
                </div>
                <div style="display: flex; align-items: center; gap: 0.3rem;">
                  <div style="width: 12px; height: 12px; background: #e74c3c;"></div>
                  <span>Banking</span>
                </div>
                <div style="display: flex; align-items: center; gap: 0.3rem;">
                  <div style="width: 12px; height: 12px; background: #2ecc71;"></div>
                  <span>Sales</span>
                </div>
              </div>
              <canvas id="seasonalityChart" height="250"></canvas>
            </div>
          </div>
        </div>
        
        <!-- Revenue Selection Panels -->
        <div style="border: 1px solid var(--border); border-radius: 8px; overflow: hidden; margin-bottom: 2rem;">
          <table style="width: 100%; border-collapse: collapse; font-size: 0.9rem;">
            <thead>
              <tr style="background: var(--panel);">
                <th style="padding: 0.75rem; text-align: left; width: 10%;">Feature</th>
                <th style="padding: 0.75rem; text-align: left; width: 15%;">Source</th>
                <th style="padding: 0.75rem; text-align: left; width: 10%;">Timeframe</th>
                <th style="padding: 0.75rem; text-align: left; width: 10%;">Value</th>
                <th style="padding: 0.75rem; text-align: left; width: 10%;">Selected</th>
                <th style="padding: 0.75rem; text-align: left; width: 10%;">Feature</th>
                <th style="padding: 0.75rem; text-align: left; width: 15%;">Source</th>
                <th style="padding: 0.75rem; text-align: left; width: 10%;">Timeframe</th>
                <th style="padding: 0.75rem; text-align: left; width: 10%;">Value</th>
                <th style="padding: 0.75rem; text-align: left; width: 10%;">Selected</th>
              </tr>
            </thead>
            <tbody>
              <tr style="border-bottom: 1px solid var(--border);">
                <td>Revenue</td>
                <td>Accounting PL</td>
                <td>L3M</td>
                <td>617,989.16</td>
                <td><input type="checkbox" checked /></td>
                <td>Avg YoY Growth</td>
                <td>Accounting PL</td>
                <td>L6M</td>
                <td>2.4%</td>
                <td><input type="checkbox" checked /></td>
              </tr>
              <tr style="border-bottom: 1px solid var(--border);">
                <td>Revenue</td>
                <td>Accounting PL</td>
                <td>L6M</td>
                <td>931,568</td>
                <td><input type="checkbox" /></td>
                <td>Avg YoY Growth</td>
                <td>Accounting PL</td>
                <td>L6M</td>
                <td>31.3%</td>
                <td><input type="checkbox" /></td>
              </tr>
              <tr style="border-bottom: 1px solid var(--border);">
                <td>Revenue</td>
                <td>Accounting PL</td>
                <td>L12M</td>
                <td>896,407</td>
                <td><input type="checkbox" /></td>
                <td>Avg YoY Growth</td>
                <td>Accounting PL</td>
                <td>L6M</td>
                <td>39.9%</td>
                <td><input type="checkbox" /></td>
              </tr>
              <tr style="border-bottom: 1px solid var(--border);">
                <td>Revenue</td>
                <td>Banking</td>
                <td>L3M</td>
                <td>1,977,850.58</td>
                <td><input type="checkbox" /></td>
                <td>Avg YoY Growth</td>
                <td>Banking</td>
                <td>L3M</td>
                <td>227.0%</td>
                <td><input type="checkbox" /></td>
              </tr>
              <tr style="border-bottom: 1px solid var(--border);">
                <td>Revenue</td>
                <td>Banking</td>
                <td>L6M</td>
                <td>2,302,827</td>
                <td><input type="checkbox" /></td>
                <td>Avg YoY Growth</td>
                <td>Banking</td>
                <td>L6M</td>
                <td>280.7%</td>
                <td><input type="checkbox" /></td>
              </tr>
              <tr style="border-bottom: 1px solid var(--border);">
                <td>Revenue</td>
                <td>Banking</td>
                <td>L12M</td>
                <td>1,139,832</td>
                <td><input type="checkbox" /></td>
                <td>Avg YoY Growth</td>
                <td>Banking</td>
                <td>L12M</td>
                <td>154.6%</td>
                <td><input type="checkbox" /></td>
              </tr>
              <tr style="border-bottom: 1px solid var(--border);">
                <td>Revenue</td>
                <td>Sales</td>
                <td>L3M</td>
                <td>847,211</td>
                <td><input type="checkbox" /></td>
                <td>Avg YoY Growth</td>
                <td>Sales</td>
                <td>L3M</td>
                <td>15.9%</td>
                <td><input type="checkbox" /></td>
              </tr>
              <tr style="border-bottom: 1px solid var(--border);">
                <td>Revenue</td>
                <td>Sales</td>
                <td>L6M</td>
                <td>1,037,828</td>
                <td><input type="checkbox" /></td>
                <td>Avg YoY Growth</td>
                <td>Sales</td>
                <td>L6M</td>
                <td>15.4%</td>
                <td><input type="checkbox" /></td>
              </tr>
              <tr style="border-bottom: 1px solid var(--border);">
                <td>Revenue</td>
                <td>Sales</td>
                <td>L12M</td>
                <td>1,084,814</td>
                <td><input type="checkbox" /></td>
                <td>Avg YoY Growth</td>
                <td>Sales</td>
                <td>L12M</td>
                <td>28.9%</td>
                <td><input type="checkbox" /></td>
              </tr>
              <tr style="border-bottom: 1px solid var(--border);">
                <td>Override</td>
                <td></td>
                <td></td>
                <td></td>
                <td><input type="checkbox" /></td>
                <td>Override</td>
                <td></td>
                <td></td>
                <td></td>
                <td><input type="checkbox" /></td>
              </tr>
              <tr>
                <td>Reason: xyz</td>
                <td colspan="4"></td>
                <td>Reason:</td>
                <td colspan="4"></td>
              </tr>
            </tbody>
          </table>
        </div>
        
        <!-- Seasonality Selection Panel -->
        <div style="border: 1px solid var(--border); border-radius: 8px; overflow: hidden; margin-bottom: 2rem;">
          <table style="width: 100%; border-collapse: collapse; font-size: 0.9rem;">
            <thead>
              <tr style="background: var(--panel);">
                <th style="padding: 0.75rem; text-align: left; width: 10%;">Feature</th>
                <th style="padding: 0.75rem; text-align: left; width: 15%;">Source</th>
                <th style="padding: 0.75rem; text-align: left; width: 10%;">Timeframe</th>
                <th style="padding: 0.75rem; text-align: left; width: 10%;">Value</th>
                <th style="padding: 0.75rem; text-align: left; width: 10%;">Selected</th>
                <th style="padding: 0.75rem; text-align: left; width: 10%;">Feature</th>
                <th style="padding: 0.75rem; text-align: left; width: 15%;">Source</th>
                <th style="padding: 0.75rem; text-align: left; width: 10%;">Timeframe</th>
                <th style="padding: 0.75rem; text-align: left; width: 10%;">Value</th>
                <th style="padding: 0.75rem; text-align: left; width: 10%;">Selected</th>
              </tr>
            </thead>
            <tbody>
              <tr style="border-bottom: 1px solid var(--border);">
                <td>Seasonality</td>
                <td>Accounting PL</td>
                <td>L12M</td>
                <td>33.3%</td>
                <td><input type="checkbox" checked /></td>
                <td>Revenue LTM</td>
                <td>Accounting PL</td>
                <td>L12M</td>
                <td>13,469,495</td>
                <td><input type="checkbox" checked /></td>
              </tr>
              <tr style="border-bottom: 1px solid var(--border);">
                <td>Seasonality</td>
                <td>Banking</td>
                <td>L12M</td>
                <td>24.5%</td>
                <td><input type="checkbox" /></td>
                <td>Override</td>
                <td></td>
                <td></td>
                <td></td>
                <td><input type="checkbox" /></td>
              </tr>
              <tr style="border-bottom: 1px solid var(--border);">
                <td>Seasonality</td>
                <td>Sales</td>
                <td>L12M</td>
                <td>33.3%</td>
                <td><input type="checkbox" /></td>
                <td>Reason:</td>
                <td colspan="4"></td>
              </tr>
              <tr style="border-bottom: 1px solid var(--border);">
                <td>Override</td>
                <td></td>
                <td></td>
                <td></td>
                <td><input type="checkbox" /></td>
                <td>Revenue LTM</td>
                <td>Accounting PL</td>
                <td>L12M</td>
                <td>10,792,826</td>
                <td><input type="checkbox" /></td>
              </tr>
              <tr style="border-bottom: 1px solid var(--border);">
                <td>Reason:</td>
                <td colspan="4"></td>
                <td>Revenue LTM</td>
                <td>Banking</td>
                <td>L12M</td>
                <td>19,477,988</td>
                <td><input type="checkbox" /></td>
              </tr>
              <tr style="border-bottom: 1px solid var(--border);">
                <td>Seasonality LY</td>
                <td>Accounting PL</td>
                <td>L12M</td>
                <td>17.0%</td>
                <td><input type="checkbox" checked /></td>
                <td>Revenue LTM</td>
                <td>Sales</td>
                <td>L12M</td>
                <td>13,017,770</td>
                <td><input type="checkbox" /></td>
              </tr>
              <tr style="border-bottom: 1px solid var(--border);">
                <td>Seasonality LY</td>
                <td>Banking</td>
                <td>L12M</td>
                <td>11.4%</td>
                <td><input type="checkbox" /></td>
                <td>Override</td>
                <td></td>
                <td></td>
                <td></td>
                <td><input type="checkbox" /></td>
              </tr>
              <tr style="border-bottom: 1px solid var(--border);">
                <td>Seasonality LY</td>
                <td>Sales</td>
                <td>L12M</td>
                <td>16.8%</td>
                <td><input type="checkbox" /></td>
                <td>Reason:</td>
                <td colspan="4"></td>
              </tr>
              <tr>
                <td>Override</td>
                <td></td>
                <td></td>
                <td></td>
                <td><input type="checkbox" /></td>
                <td></td>
                <td colspan="4"></td>
              </tr>
              <tr>
                <td>Reason:</td>
                <td colspan="4"></td>
                <td></td>
                <td colspan="4"></td>
              </tr>
            </tbody>
          </table>
        </div>
      `;
      container.appendChild(contentDiv);
      
      // Initialize charts after DOM is loaded
      setTimeout(() => {
        createRevenueChart();
        createSeasonalityChart();
      }, 100);
    }
    
    // Create Revenue Chart
    function createRevenueChart() {
      const ctx = document.getElementById('revenueChart').getContext('2d');
      
      // Sample data
      const months = ['Mar/22', 'Apr/22', 'May/22', 'Jun/22', 'Jul/22', 'Aug/22', 'Sep/22', 'Oct/22', 'Nov/22', 'Dec/22', 'Jan/23', 'Feb/23', 'Mar/23', 'Apr/23', 'May/23'];
      
      const salesData = [1000000, 1200000, 900000, 700000, 1500000, 1700000, 1300000, 800000, 1100000, 1000000, 900000, 1400000, 2100000, 1200000, 1300000];
      const bankData = [800000, 900000, 600000, 500000, 700000, 1200000, 800000, 700000, 1100000, 800000, 900000, 3500000, 1800000, 2000000, 2000000];
      const accData = [900000, 1000000, 700000, 600000, 800000, 1000000, 900000, 1200000, 1300000, 900000, 700000, 1300000, 1500000, 900000, 1000000];
      
      // Shopify data (bar chart)
      const shopifyData = [300000, 400000, 350000, 300000, 450000, 500000, 400000, 350000, 450000, 400000, 350000, 500000, 600000, 400000, 450000];
      
      new Chart(ctx, {
        type: 'line',
        data: {
          labels: months,
          datasets: [
            {
              label: 'Sales - Total Sales',
              data: salesData,
              borderColor: '#2ecc71',
              backgroundColor: 'transparent',
              tension: 0.4,
              borderWidth: 2,
              pointRadius: 0
            },
            {
              label: 'Bank - Revenue',
              data: bankData,
              borderColor: '#e74c3c',
              backgroundColor: 'transparent',
              tension: 0.4,
              borderWidth: 2,
              pointRadius: 0
            },
            {
              label: 'Acc - Net sales',
              data: accData,
              borderColor: '#3498db',
              backgroundColor: 'transparent',
              tension: 0.4,
              borderWidth: 2,
              pointRadius: 0
            },
            {
              label: 'Shopify',
              type: 'bar',
              data: shopifyData,
              backgroundColor: 'rgba(243, 156, 18, 0.4)',
              borderColor: 'rgba(243, 156, 18, 0.8)',
              borderWidth: 1
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            x: {
              grid: {
                display: false
              },
              ticks: {
                font: {
                  size: 9
                },
                maxRotation: 45,
                minRotation: 45
              }
            },
            y: {
              grid: {
                color: 'rgba(255, 255, 255, 0.1)'
              },
              ticks: {
                callback: function(value) {
                  if (value === 0) return '0';
                  return '$' + (value / 1000000).toFixed(1) + 'M';
                },
                font: {
                  size: 10
                }
              }
            }
          },
          plugins: {
            legend: {
              display: false
            },
            tooltip: {
              callbacks: {
                label: function(context) {
                  return context.dataset.label + ': $' + context.parsed.y.toLocaleString();
                }
              }
            }
          }
        }
      });
    }
    
    // Create Seasonality Chart
    function createSeasonalityChart() {
      const ctx = document.getElementById('seasonalityChart').getContext('2d');
      
      // Sample data
      const quarters = ['Q2-2023', 'Q3-2023', 'Q4-2023', 'Q1-2024', 'Q2-2024', 'Q3-2024', 'Q4-2024'];
      
      const accountingData = [24, 21, 30, 17, 25, 23, 34];
      const bankingData = [24, 20, 30, 11, 18, 17, 49];
      const salesData = [25, 20, 33, 17, 25, 22, 36];
      
      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: quarters,
          datasets: [
            {
              label: 'Accounting',
              data: accountingData,
              backgroundColor: '#3498db',
              borderColor: '#3498db',
              borderWidth: 1
            },
            {
              label: 'Banking',
              data: bankingData,
              backgroundColor: '#e74c3c',
              borderColor: '#e74c3c',
              borderWidth: 1
            },
            {
              label: 'Sales',
              data: salesData,
              backgroundColor: '#2ecc71',
              borderColor: '#2ecc71',
              borderWidth: 1
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            x: {
              grid: {
                display: false
              }
            },
            y: {
              grid: {
                color: 'rgba(255, 255, 255, 0.1)'
              },
              ticks: {
                callback: function(value) {
                  return value + '%';
                }
              },
              min: 0,
              max: 50
            }
          },
          plugins: {
            legend: {
              display: false
            },
            tooltip: {
              callbacks: {
                label: function(context) {
                  return context.dataset.label + ': ' + context.parsed.y + '%';
                }
              }
            }
          }
        }
      });
    }
  </script>
</body>
</html>
